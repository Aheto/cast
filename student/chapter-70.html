<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 71 ‚Äî Letter 'x' in Closed Syllables"/>
  <title>Mini OpenStax ‚Äî Lesson 71: Letter x</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn { background: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
    .btn:hover { background: #218838; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 71: Letter x</h1>
        <div class="lo-tags" id="lo-tags">LO PH71: Decode words with the letter 'x' in closed syllables</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <!-- üìö 5-BUTTON NAVIGATION BAR (Home + current + next 3 lessons) -->
    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Words ending with the letter <strong>x</strong> in closed syllables:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud. All words are decodable from Lessons 2‚Äì71:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div class="quiz" id="quiz-container">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';

      const currentChapter = 70;    // chapter-70.html = Lesson 71
      const maxChapter = 150;       // Update when adding more lessons

      const CHAPTER_CONFIG = {
        title: "Lesson 71: Letter x",
        loTags: ["LO PH71: Decode words with the letter 'x' in closed syllables"],
        contentWords: [
          "ax", "fax", "lax", "Max", "sax", "tax", "wax", "Rex", "Tex", "vex", "flex", "next", "text",
          "fix", "mix", "nix", "six", "sixth", "ox", "box", "fox", "pox", "flux"
        ],
        sentences: [
          "Max got a fax from Rick.",
          "Matt can chop up the log with an ax.",
          "A fox can catch a hen and a chick.",
          "A fox can snatch an egg from a nest.",
          "Rex did well on the next math quiz.",
          "Rex got a gift in a box from Mom.",
          "A man at the ranch kept an ox in a pen.",
          "Did the bug buzz at Max? Did the bug vex Max?",
          "The shop can fix the fan belt on the truck.",
          "Tex will wax the truck and buff the wax with a soft cloth."
        ],
        whatsappNumber: "233257320201",
        assessmentItems: [
          { id: "1", prompt: "Which word ends with the letter 'x'?", options: [{id:"a",text:"fox",is_correct:true},{id:"b",text:"fog",is_correct:false},{id:"c",text:"for",is_correct:false},{id:"d",text:"form",is_correct:false}] },
          { id: "2", prompt: "Which is NOT a Lesson 71 word?", options: [{id:"a",text:"wax",is_correct:false},{id:"b",text:"fix",is_correct:false},{id:"c",text:"mix",is_correct:false},{id:"d",text:"hex",is_correct:true}] },
          { id: "3", prompt: "What sound does 'x' make at the end of 'box'?", options: [{id:"a",text:"/ks/",is_correct:true},{id:"b",text:"/gz/",is_correct:false},{id:"c",text:"/z/",is_correct:false},{id:"d",text:"/s/",is_correct:false}] },
          { id: "4", prompt: "Which word means 'to repair'?", options: [{id:"a",text:"fix",is_correct:true},{id:"b",text:"mix",is_correct:false},{id:"c",text:"nix",is_correct:false},{id:"d",text:"lax",is_correct:false}] },
          { id: "5", prompt: "How many letters in 'sixth'?", options: [{id:"a",text:"4",is_correct:false},{id:"b",text:"5",is_correct:true},{id:"c",text:"6",is_correct:false},{id:"d",text:"3",is_correct:false}] },
          { id: "6", prompt: "Which sentence uses only Lesson 71 words?", options: [{id:"a",text:"Rex got a gift in a box from Mom.",is_correct:true},{id:"b",text:"Rex got a car from Mom.",is_correct:false},{id:"c",text:"Rex sat on a mat.",is_correct:false},{id:"d",text:"Rex ran to a map.",is_correct:false}] },
          { id: "7", prompt: "Which word refers to a male name often used in stories?", options: [{id:"a",text:"Rex",is_correct:true},{id:"b",text:"Max",is_correct:false},{id:"c",text:"Tex",is_correct:false},{id:"d",text:"fox",is_correct:false}] },
          { id: "8", prompt: "What closes the vowel in 'wax'?", options: [{id:"a",text:"Silent e",is_correct:false},{id:"b",text:"The letter 'x'",is_correct:true},{id:"c",text:"It's open",is_correct:false},{id:"d",text:"Double vowel",is_correct:false}] },
          { id: "9", prompt: "In 'Max got a fax from Rick', how many Lesson 71 words?", options: [{id:"a",text:"3",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"1",is_correct:false},{id:"d",text:"0",is_correct:false}] },
          { id: "10", prompt: "Which word means 'to annoy or irritate'?", options: [{id:"a",text:"vex",is_correct:true},{id:"b",text:"lax",is_correct:false},{id:"c",text:"nix",is_correct:false},{id:"d",text:"flux",is_correct:false}] },
          { id: "11", prompt: "Which word describes a contagious skin disease (historical)?" , options: [{id:"a",text:"pox",is_correct:true},{id:"b",text:"ox",is_correct:false},{id:"c",text:"box",is_correct:false},{id:"d",text:"fox",is_correct:false}] },
          { id: "12", prompt: "Which word ends with 'x' and means 'to apply a protective coating'?", options: [{id:"a",text:"wax",is_correct:true},{id:"b",text:"fix",is_correct:false},{id:"c",text:"mix",is_correct:false},{id:"d",text:"six",is_correct:false}] },
          { id: "13", prompt: "Which sentence is from Lesson 71?", options: [{id:"a",text:"A fox can catch a hen and a chick.",is_correct:true},{id:"b",text:"A fox sat on a mat.",is_correct:false},{id:"c",text:"A fox ran to a map.",is_correct:false},{id:"d",text:"A fox had a car.",is_correct:false}] },
          { id: "14", prompt: "How many consonants in 'flex'?", options: [{id:"a",text:"2",is_correct:false},{id:"b",text:"3",is_correct:true},{id:"c",text:"4",is_correct:false},{id:"d",text:"1",is_correct:false}] },
          { id: "15", prompt: "Which word is NOT a verb?", options: [{id:"a",text:"box",is_correct:true},{id:"b",text:"fix",is_correct:false},{id:"c",text:"mix",is_correct:false},{id:"d",text:"wax",is_correct:false}] },
          { id: "16", prompt: "What syllable type is 'tax'?", options: [{id:"a",text:"Open",is_correct:false},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Closed",is_correct:true},{id:"d",text:"R-controlled",is_correct:false}] },
          { id: "17", prompt: "Which word describes a large animal sometimes used for plowing?", options: [{id:"a",text:"ox",is_correct:true},{id:"b",text:"fox",is_correct:false},{id:"c",text:"pox",is_correct:false},{id:"d",text:"box",is_correct:false}] },
          { id: "18", prompt: "Which word might complete: 'Tex will ___ the truck'?", options: [{id:"a",text:"wax",is_correct:true},{id:"b",text:"fix",is_correct:false},{id:"c",text:"mix",is_correct:false},{id:"d",text:"nix",is_correct:false}] },
          { id: "19", prompt: "Which word appears in both 'next math quiz' and 'Rex did well'?", options: [{id:"a",text:"next",is_correct:true},{id:"b",text:"Rex",is_correct:true},{id:"c",text:"quiz",is_correct:false},{id:"d",text:"math",is_correct:false}] },
          { id: "20", prompt: "What letter is taught in Lesson 71?", options: [{id:"a",text:"x",is_correct:true},{id:"b",text:"z",is_correct:false},{id:"c",text:"q",is_correct:false},{id:"d",text:"j",is_correct:false}] }
        ]
      };

      // Render word list
      function renderWords() {
        const container = document.getElementById('word-list');
        container.innerHTML = CHAPTER_CONFIG.contentWords.map(word =>
          `<span class="word-item">${word}</span>`
        ).join('');
      }

      // Render sentences
      function renderSentences() {
        const container = document.getElementById('sentences');
        container.innerHTML = CHAPTER_CONFIG.sentences.map(s =>
          `<p>${s}</p>`
        ).join('');
      }

      // ‚úÖ UNLIMITED NAVIGATION
      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [];
        buttons.push({ label: "Home", url: "../index.html", active: false });
        for (let i = 0; i < 4; i++) {
          const chapterNum = currentChapter + i;
          if (chapterNum > maxChapter) break;
          const lessonNum = chapterNum + 1;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${chapterNum}.html`,
            active: (i === 0)
          });
        }
        nav.innerHTML = buttons.map(btn => `
          <a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">
            ${btn.label}
          </a>
        `).join('');
      }

      // Render quiz
      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        form.innerHTML = CHAPTER_CONFIG.assessmentItems.map(q => `
          <div class="question">
            <strong>${q.id}. ${q.prompt}</strong>
            <div class="options">
              ${q.options.map(opt => `
                <div class="option">
                  <label>
                    <input type="radio" name="q${q.id}" value="${opt.id}" required> ${opt.id.toUpperCase()}. ${opt.text}
                  </label>
                </div>
              `).join('')}
            </div>
          </div>
        `).join('');
      }

      // WhatsApp feedback
      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0;
        let correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const userAns = answers[i];
          const correctOpt = item.options.find(o => o.is_correct);
          const isCorrect = userAns === correctOpt.id;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt}\n   ‚úÖ Correct: ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt}\n   ‚ùå You chose: ${item.options.find(o => o.id === userAns)?.text || '‚Äî'}\n   ‚úÖ Correct: ${correctOpt.text}`);
          }
        });

        const score = `${correctCount}/20}`;
        const summary = `*Mini OpenStax ‚Äî Phonics Lesson 71*\nStudent: [Name]\nScore: ${score}\n\n`;
        const correctStr = correctList.length ? '‚úÖ CORRECT:\n' + correctList.join('\n\n') + '\n\n' : '';
        const incorrectStr = incorrectList.length ? '‚ùå INCORRECT:\n' + incorrectList.join('\n\n') : '';
        const message = encodeURIComponent(summary + correctStr + incorrectStr + `\nReport generated via Mini OpenStax. Share with instructor: https://wa.me/${CHAPTER_CONFIG.whatsappNumber}`);
        const whatsappLink = `https://wa.me/${CHAPTER_CONFIG.whatsappNumber}?text=${message}`;

        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}</h3>
            <p><strong>${correctCount >= 15 ? 'Excellent! You‚Äôve mastered the letter "x"!' : correctCount >= 10 ? 'Good! Review missed items.' : 'Practice Lesson 71 words again.'}</strong></p>
            <p><a href="${whatsappLink}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report to Instructor</a></p>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const selected = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(selected ? selected.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
