<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 81: Sight Words"/>
  <title>Mini OpenStax ‚Äî Lesson 81: Sight Words</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn {
      background: #28a745; color: white; border: none; padding: 0.5rem 1rem;
      border-radius: 4px; cursor: pointer; font-size: 1rem; margin-right: 0.5rem;
    }
    .btn:hover { background: #218838; }
    .btn-secondary { background: #6c757d; }
    .btn-secondary:hover { background: #5a6268; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 81: Sight Words</h1>
        <div class="lo-tags" id="lo-tags">LO PH81: Read high-frequency sight words</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Common <strong>Sight Words</strong> for this lesson:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div id="student-name-prompt" class="section" style="display:none;">
        <h2>üë§ Your Name</h2>
        <div id="name-display"></div>
        <input type="text" id="student-name" placeholder="Enter your name" maxlength="30"
          style="padding:0.5rem;font-size:1rem;width:100%;margin:0.5rem 0;display:none;">
        <div id="name-buttons"></div>
      </div>

      <div class="quiz" id="quiz-container" style="display:none;">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';
      window.startTime = Date.now();

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      const currentChapter = 80; // chapter-80.html = Lesson 81
      const maxChapter = 261;
      const WHATSAPP_NUMBER = "233257320201";

      const CHAPTER_CONFIG = {
        title: "Lesson 81: Sight Words",
        loTags: ["LO PH81: Read high-frequency sight words"],
        contentWords: ["we", "me", "be", "he", "she", "do", "who", "to", "two"],
        sentences: [
          "1) What can I do to help you?",
          "2) Beth can spell, and she can do math.",
          "3) Mom said, \"Who will pick up the trash?\"",
          "4) Max said, \"Let me do it, Mom.\"",
          "5) We can catch a bus at the bus stop at two.",
          "6) Who will flunk the test, and who will pass?",
          "7) Frank said, \"Where are we? Are we lost?\"",
          "8) Jeff says he can swim the length of the pond."
        ],
        assessmentItems: [
          { id: "1", prompt: "In sentence 1, what does the speaker ask?", options: [{id:"a",text:"What can I do to help you?",is_correct:true},{id:"b",text:"Where are we?",is_correct:false},{id:"c",text:"Who is there?",is_correct:false},{id:"d",text:"Can you spell?",is_correct:false}]},
          { id: "2", prompt: "What two things can Beth do?", options: [{id:"a",text:"spell and do math",is_correct:true},{id:"b",text:"swim and run",is_correct:false},{id:"c",text:"catch a bus",is_correct:false},{id:"d",text:"pick up trash",is_correct:false}]},
          { id: "3", prompt: "Who did Mom ask to pick up the trash?", options: [{id:"a",text:"She asked 'Who will'?",is_correct:true},{id:"b",text:"Beth",is_correct:false},{id:"c",text:"Frank",is_correct:false},{id:"d",text:"Jeff",is_correct:false}]},
          { id: "4", prompt: "What did Max say to Mom?", options: [{id:"a",text:"Let me do it",is_correct:true},{id:"b",text:"We are lost",is_correct:false},{id:"c",text:"I can swim",is_correct:false},{id:"d",text:"I can spell",is_correct:false}]},
          { id: "5", prompt: "At what time can they catch the bus?", options: [{id:"a",text:"at two",is_correct:true},{id:"b",text:"at lunch",is_correct:false},{id:"c",text:"at dusk",is_correct:false},{id:"d",text:"at camp",is_correct:false}]},
          { id: "6", prompt: "What is Frank worried about in sentence 7?", options: [{id:"a",text:"being lost",is_correct:true},{id:"b",text:"the math test",is_correct:false},{id:"c",text:"the trash",is_correct:false},{id:"d",text:"the bus",is_correct:false}]},
          { id: "7", prompt: "What does Jeff say he can do?", options: [{id:"a",text:"swim the length of the pond",is_correct:true},{id:"b",text:"catch a bus",is_correct:false},{id:"c",text:"spell math",is_correct:false},{id:"d",text:"help Mom",is_correct:false}]},
          { id: "8", prompt: "Which word is a pronoun for a girl?", options: [{id:"a",text:"she",is_correct:true},{id:"b",text:"he",is_correct:false},{id:"c",text:"we",is_correct:false},{id:"d",text:"me",is_correct:false}]},
          { id: "9", prompt: "Which word is a pronoun for a boy?", options: [{id:"a",text:"he",is_correct:true},{id:"b",text:"she",is_correct:false},{id:"c",text:"we",is_correct:false},{id:"d",text:"me",is_correct:false}]},
          { id: "10", prompt: "Which word means the number 2?", options: [{id:"a",text:"two",is_correct:true},{id:"b",text:"to",is_correct:false},{id:"c",text:"do",is_correct:false},{id:"d",text:"who",is_correct:false}]},
          { id: "11", prompt: "Which word asks about a person?", options: [{id:"a",text:"who",is_correct:true},{id:"b",text:"we",is_correct:false},{id:"c",text:"me",is_correct:false},{id:"d",text:"be",is_correct:false}]},
          { id: "12", prompt: "In sentence 2, Beth can spell, and ____ can do math.", options: [{id:"a",text:"she",is_correct:true},{id:"b",text:"he",is_correct:false},{id:"c",text:"we",is_correct:false},{id:"d",text:"me",is_correct:false}]},
          { id: "13", prompt: "Complete the sentence: 'What can I ___ to help you?'", options: [{id:"a",text:"do",is_correct:true},{id:"b",text:"be",is_correct:false},{id:"c",text:"to",is_correct:false},{id:"d",text:"two",is_correct:false}]},
          { id: "14", prompt: "Which word rhymes with 'me'?", options: [{id:"a",text:"be",is_correct:true},{id:"b",text:"do",is_correct:false},{id:"c",text:"to",is_correct:false},{id:"d",text:"who",is_correct:false}]},
          { id: "15", prompt: "Which word rhymes with 'do'?", options: [{id:"a",text:"who",is_correct:true},{id:"b",text:"be",is_correct:false},{id:"c",text:"me",is_correct:false},{id:"d",text:"she",is_correct:false}]},
          { id: "16", prompt: "What does 'we' refer to?", options: [{id:"a",text:"a group of people including me",is_correct:true},{id:"b",text:"only me",is_correct:false},{id:"c",text:"only one boy",is_correct:false},{id:"d",text:"only one girl",is_correct:false}]},
          { id: "17", prompt: "In sentence 5, where can they catch the bus?", options: [{id:"a",text:"at the bus stop",is_correct:true},{id:"b",text:"at the pond",is_correct:false},{id:"c",text:"at camp",is_correct:false},{id:"d",text:"at the bank",is_correct:false}]},
          { id: "18", prompt: "Which sentence mentions a 'test'?", options: [{id:"a",text:"Sentence 6",is_correct:true},{id:"b",text:"Sentence 1",is_correct:false},{id:"c",text:"Sentence 4",is_correct:false},{id:"d",text:"Sentence 8",is_correct:false}]},
          { id: "19", prompt: "Complete the word: 'M _ ' (refers to myself).", options: [{id:"a",text:"e",is_correct:true},{id:"b",text:"o",is_correct:false},{id:"c",text:"u",is_correct:false},{id:"d",text:"i",is_correct:false}]},
          { id: "20", prompt: "Who is speaking in sentence 7?", options: [{id:"a",text:"Frank",is_correct:true},{id:"b",text:"Max",is_correct:false},{id:"c",text:"Jeff",is_correct:false},{id:"d",text:"Beth",is_correct:false}]}
        ]
      };

      function renderWords() {
        document.getElementById('word-list').innerHTML =
          CHAPTER_CONFIG.contentWords.map(w => `<span class="word-item">${w}</span>`).join('');
      }

      function renderSentences() {
        document.getElementById('sentences').innerHTML =
          CHAPTER_CONFIG.sentences.map(s => `<p>${s}</p>`).join('');
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [{ label: "Home", url: "../index.html", active: false }];
        for (let i = 0; i < 4; i++) {
          const c = currentChapter + i;
          const lessonNum = c + 1;
          if (c > maxChapter) break;
          buttons.push({ label: `Lesson ${lessonNum}`, url: `chapter-${c}.html`, active: i === 0 });
        }
        nav.innerHTML = buttons.map(b => `<a href="${b.url}" class="chapter-btn ${b.active ? 'active' : ''}">${b.label}</a>`).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};
        form.innerHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          const opts = shuffle([...q.options]);
          const correct = q.options.find(o => o.is_correct);
          window.quizCorrectMap[q.id] = correct.id;
          const optHtml = opts.map((o, i) => {
            const L = String.fromCharCode(65 + i);
            return `<div class="option"><label><input type="radio" name="q${q.id}" value="${o.id}" required> ${L}. ${o.text}</label></div>`;
          }).join('');
          return `<div class="question"><strong>${q.id}. ${q.prompt}</strong><div class="options">${optHtml}</div></div>`;
        }).join('');
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0, correctList = [], incorrectList = [];
        items.forEach((item, i) => {
          const ans = answers[i];
          const correctId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctId);
          if (ans === correctId) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt} ‚Üí ‚úÖ ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt} ‚Üí ‚ùå Your answer: ${item.options.find(o => o.id === ans)?.text || '‚Äî'} | ‚úÖ ${correctOpt.text}`);
          }
        });

        const score = correctCount, mastery = score >= 15;
        const timeOnTask = Math.floor((Date.now() - window.startTime) / 1000);
        const attemptsKey = `quiz_attempts_${currentChapter}`;
        const attempts = (parseInt(localStorage.getItem(attemptsKey)) || 0) + 1;
        localStorage.setItem(attemptsKey, attempts);
        localStorage.setItem(`mastery_${currentChapter}`, mastery ? '1' : '0');
        const studentName = localStorage.getItem('student_name') || '[Name]';

        let report = `*Mini OpenStax ‚Äî ${CHAPTER_CONFIG.title}*\nStudent: ${studentName}\nScore: ${score}/20 (${Math.round(score/20*100)}%) ‚Äî ${mastery ? '‚úÖ MASTERED' : '‚ùå Needs Review'}\nTime: ${timeOnTask}s | Attempts: ${attempts}\n\n`;
        if (correctList.length) report += `‚úÖ CORRECT:\n${correctList.join('\n')}\n\n`;
        if (incorrectList.length) report += `‚ùå INCORRECT:\n${incorrectList.join('\n')}\n\n`;
        report += `Report generated via Mini OpenStax.`;

        const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(report)}`;
        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}/20</h3>
            <p><strong>${mastery ? 'üéâ Excellent!' : 'Keep practicing.'}</strong></p>
            <p>Time: ${timeOnTask}s | Attempts: ${attempts}</p>
            <a href="${url}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report via WhatsApp</a>
          </div>`;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const el = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(el ? el.value : null);
          }
          if (answers.includes(null)) { alert("Please answer all questions."); return; }
          showFeedback(answers);
        });
      }

      function initNamePrompt() {
        const saved = localStorage.getItem('student_name');
        const promptDiv = document.getElementById('student-name-prompt');
        const quizDiv = document.getElementById('quiz-container');
        const display = document.getElementById('name-display');
        const input = document.getElementById('student-name');
        const buttons = document.getElementById('name-buttons');

        promptDiv.style.display = 'block';
        if (saved) {
          display.innerHTML = `<p><strong>Current name:</strong> ${saved}</p>`;
          buttons.innerHTML = `<button type="button" class="btn" id="keep-btn">‚úÖ Keep This Name</button> <button type="button" class="btn btn-secondary" id="change-btn">‚úèÔ∏è Change</button>`;
          document.getElementById('keep-btn').onclick = () => { promptDiv.style.display = 'none'; quizDiv.style.display = 'block'; };
          document.getElementById('change-btn').onclick = () => { display.style.display = 'none'; input.style.display = 'block'; input.value = ''; input.focus(); buttons.innerHTML = `<button type="button" class="btn" id="save-new">üíæ Save & Start</button>`; document.getElementById('save-new').onclick = saveName; };
        } else {
          display.style.display = 'none'; input.style.display = 'block'; buttons.innerHTML = `<button type="button" class="btn" id="save-first">üíæ Save & Start</button>`; document.getElementById('save-first').onclick = saveName;
        }

        function saveName() {
          const name = input.value.trim();
          if (name) { localStorage.setItem('student_name', name); promptDiv.style.display = 'none'; quizDiv.style.display = 'block'; }
          else { alert("Please enter your name."); }
        }
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation(); renderWords(); renderSentences(); renderQuiz(); setupQuizListeners(); initNamePrompt();
      }

      init();
    })();
  </script>
</body>
</html>
