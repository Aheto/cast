<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 215 ‚Äî R-Controlled er = /…ôr/"/>
  <title>Mini OpenStax ‚Äî Lesson 215: er = /…ôr/</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn { background: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
    .btn:hover { background: #218838; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 215: er = /…ôr/</h1>
        <div class="lo-tags" id="lo-tags">LO PH215: Decode words with r-controlled er = /…ôr/</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Words with the <strong>r-controlled</strong> <em>er</em> making the <strong>/…ôr/</strong> sound:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud. All words are decodable from Lessons 2‚Äì215:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div class="quiz" id="quiz-container">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      const currentChapter = 214;   // chapter-214.html = Lesson 215
      const maxChapter = 261;

      const CHAPTER_CONFIG = {
        title: "Lesson 215: er = /…ôr/",
        loTags: ["LO PH215: Decode words with r-controlled er = /…ôr/"],
        contentWords: [
          "desert", "expert", "modern", "concert", "concern", "deserve", "superb", "energy", "general", "several",
          "advertise", "interest", "interesting", "interrupt", "eternal", "entertain", "afternoon", "yesterday",
          "liberty", "grocery", "exercise", "understand", "camera", "emergency", "different", "difference"
        ],
        sentences: [
          "Martin is reading an interesting novel.",
          "It is rude to interrupt another person.",
          "The desert is a hot, dry and sandy place.",
          "Sally will load some new film into her camera.",
          "Bert has several goals that he plans to achieve this year.",
          "The little boy has so much energy that he cannot sit still.",
          "The clown will entertain the children with some magic tricks.",
          "Yesterday afternoon, Lou went shopping at the local grocery store."
        ],
        whatsappNumber: "233257320201",
        assessmentItems: [
          { id: "1", prompt: "Which word contains 'er' making /…ôr/?", options: [{id:"a",text:"desert",is_correct:true},{id:"b",text:"dessert",is_correct:false},{id:"c",text:"dense",is_correct:false},{id:"d",text:"deny",is_correct:false}] },
          { id: "2", prompt: "Which is NOT a Lesson 215 word?", options: [{id:"a",text:"emergency",is_correct:false},{id:"b",text:"difference",is_correct:false},{id:"c",text:"fern",is_correct:true},{id:"d",text:"grocery",is_correct:false}] },
          { id: "3", prompt: "In 'energy', what sound does 'er' make?", options: [{id:"a",text:"/…ôr/",is_correct:true},{id:"b",text:"/√§r/",is_correct:false},{id:"c",text:"/√¥r/",is_correct:false},{id:"d",text:"/er/ as in error",is_correct:false}] },
          { id: "4", prompt: "Which word means 'to provide amusement'?", options: [{id:"a",text:"entertain",is_correct:true},{id:"b",text:"interrupt",is_correct:false},{id:"c",text:"advertise",is_correct:false},{id:"d",text:"exercise",is_correct:false}] },
          { id: "5", prompt: "How many syllables in 'interesting'?", options: [{id:"a",text:"3",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"4",is_correct:false},{id:"d",text:"5",is_correct:false}] },
          { id: "6", prompt: "Which sentence uses only Lesson 215 words?", options: [{id:"a",text:"Martin is reading an interesting novel.",is_correct:true},{id:"b",text:"She sat on a mat.",is_correct:false},{id:"c",text:"He ran fast.",is_correct:false},{id:"d",text:"They played ball.",is_correct:false}] },
          { id: "7", prompt: "Which word refers to a dry, sandy region?", options: [{id:"a",text:"desert",is_correct:true},{id:"b",text:"concert",is_correct:false},{id:"c",text:"camera",is_correct:false},{id:"d",text:"liberty",is_correct:false}] },
          { id: "8", prompt: "What syllable type is in 'superb'?", options: [{id:"a",text:"R-controlled",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Open syllable",is_correct:false},{id:"d",text:"Closed syllable",is_correct:false}] },
          { id: "9", prompt: "In 'Yesterday afternoon, Lou went shopping at the local grocery store,' how many Lesson 215 words?", options: [{id:"a",text:"4",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"1",is_correct:false},{id:"d",text:"3",is_correct:false}] },
          { id: "10", prompt: "Which word means 'to break in during someone else‚Äôs speech'?", options: [{id:"a",text:"interrupt",is_correct:true},{id:"b",text:"entertain",is_correct:false},{id:"c",text:"deserve",is_correct:false},{id:"d",text:"exercise",is_correct:false}] },
          { id: "11", prompt: "Which word describes something worthy of admiration?", options: [{id:"a",text:"superb",is_correct:true},{id:"b",text:"modern",is_correct:false},{id:"c",text:"different",is_correct:false},{id:"d",text:"several",is_correct:false}] },
          { id: "12", prompt: "Which word ends with 'er' and means 'a store that sells food and household items'?", options: [{id:"a",text:"grocery",is_correct:true},{id:"b",text:"camera",is_correct:false},{id:"c",text:"emergency",is_correct:false},{id:"d",text:"difference",is_correct:false}] },
          { id: "13", prompt: "Which sentence is from Lesson 215?", options: [{id:"a",text:"The little boy has so much energy that he cannot sit still.",is_correct:true},{id:"b",text:"She likes apples.",is_correct:false},{id:"c",text:"He jumped high.",is_correct:false},{id:"d",text:"They walked home.",is_correct:false}] },
          { id: "14", prompt: "How many consonants in 'emergency'?", options: [{id:"a",text:"6",is_correct:true},{id:"b",text:"5",is_correct:false},{id:"c",text:"7",is_correct:false},{id:"d",text:"4",is_correct:false}] },
          { id: "15", prompt: "Which word means 'freedom from control or restriction'?", options: [{id:"a",text:"liberty",is_correct:true},{id:"b",text:"concert",is_correct:false},{id:"c",text:"expert",is_correct:false},{id:"d",text:"general",is_correct:false}] },
          { id: "16", prompt: "What phonics pattern is in 'exercise'?", options: [{id:"a",text:"R-controlled er = /…ôr/",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Closed syllable",is_correct:false},{id:"d",text:"Vowel team 'ie'",is_correct:false}] },
          { id: "17", prompt: "Which word refers to a device for taking photographs?", options: [{id:"a",text:"camera",is_correct:true},{id:"b",text:"concert",is_correct:false},{id:"c",text:"desert",is_correct:false},{id:"d",text:"afternoon",is_correct:false}] },
          { id: "18", prompt: "Which word might complete: 'Please don‚Äôt ___ me.'?", options: [{id:"a",text:"interrupt",is_correct:true},{id:"b",text:"entertain",is_correct:false},{id:"c",text:"advertise",is_correct:false},{id:"d",text:"deserve",is_correct:false}] },
          { id: "19", prompt: "Which word appears in both the word list and sentences?", options: [{id:"a",text:"interesting",is_correct:true},{id:"b",text:"energy",is_correct:true},{id:"c",text:"grocery",is_correct:true},{id:"d",text:"All of the above",is_correct:true}] },
          { id: "20", prompt: "What phonics concept is taught in Lesson 215?", options: [{id:"a",text:"R-controlled er = /…ôr/",is_correct:true},{id:"b",text:"Split vowel pairs",is_correct:false},{id:"c",text:"Magic E",is_correct:false},{id:"d",text:"Vowel teams",is_correct:false}] }
        ]
      };

      function renderWords() {
        const container = document.getElementById('word-list');
        container.innerHTML = CHAPTER_CONFIG.contentWords.map(word =>
          `<span class="word-item">${word}</span>`
        ).join('');
      }

      function renderSentences() {
        const container = document.getElementById('sentences');
        container.innerHTML = CHAPTER_CONFIG.sentences.map(s =>
          `<p>${s}</p>`
        ).join('');
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [];
        buttons.push({ label: "Home", url: "../index.html", active: false });
        for (let i = 0; i < 4; i++) {
          const chapterNum = currentChapter + i;
          if (chapterNum > maxChapter) break;
          const lessonNum = chapterNum + 1;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${chapterNum}.html`,
            active: (i === 0)
          });
        }
        nav.innerHTML = buttons.map(btn => `
          <a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">
            ${btn.label}
          </a>
        `).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};

        const quizHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          let shuffledOptions = [...q.options];
          shuffle(shuffledOptions);

          const correctOpt = q.options.find(opt => opt.is_correct);
          window.quizCorrectMap[q.id] = correctOpt.id;

          const optionsHTML = shuffledOptions.map((opt, idx) => {
            const label = String.fromCharCode(97 + idx).toUpperCase();
            return `
              <div class="option">
                <label>
                  <input type="radio" name="q${q.id}" value="${opt.id}" required> ${label}. ${opt.text}
                </label>
              </div>
            `;
          }).join('');

          return `
            <div class="question">
              <strong>${q.id}. ${q.prompt}</strong>
              <div class="options">
                ${optionsHTML}
              </div>
            </div>
          `;
        }).join('');

        form.innerHTML = quizHTML;
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0;
        let correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const userAns = answers[i];
          const correctOptId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctOptId);
          const isCorrect = userAns === correctOptId;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt}\n   ‚úÖ Correct: ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt}\n   ‚ùå You chose: ${item.options.find(o => o.id === userAns)?.text || '‚Äî'}\n   ‚úÖ Correct: ${correctOpt.text}`);
          }
        });

        const score = `${correctCount}/20}`;
        const summary = `*Mini OpenStax ‚Äî Phonics Lesson 215*\nStudent: [Name]\nScore: ${score}\n\n`;
        const correctStr = correctList.length ? '‚úÖ CORRECT:\n' + correctList.join('\n\n') + '\n\n' : '';
        const incorrectStr = incorrectList.length ? '‚ùå INCORRECT:\n' + incorrectList.join('\n\n') : '';
        const message = encodeURIComponent(summary + correctStr + incorrectStr + `\nReport generated via Mini OpenStax. Share with instructor: https://wa.me/${CHAPTER_CONFIG.whatsappNumber}`);
        const whatsappLink = `https://wa.me/${CHAPTER_CONFIG.whatsappNumber}?text=${message}`;

        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}</h3>
            <p><strong>${correctCount >= 15 ? 'Excellent! You‚Äôve mastered r-controlled er=/…ôr/!' : correctCount >= 10 ? 'Good! Review missed items.' : 'Practice Lesson 215 words again.'}</strong></p>
            <p><a href="${whatsappLink}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report to Instructor</a></p>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const selected = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(selected ? selected.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
