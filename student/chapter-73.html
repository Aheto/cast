<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 74: -eng Pattern with /eng/ Sound"/>
  <title>Mini OpenStax ‚Äî Lesson 74: -eng Pattern with /eng/ Sound</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn {
      background: #28a745; color: white; border: none; padding: 0.5rem 1rem;
      border-radius: 4px; cursor: pointer; font-size: 1rem; margin-right: 0.5rem;
    }
    .btn:hover { background: #218838; }
    .btn-secondary { background: #6c757d; }
    .btn-secondary:hover { background: #5a6268; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 74: -eng Pattern with /eng/ Sound</h1>
        <div class="lo-tags" id="lo-tags">LO PH74: Decode and use words with the /eng/ pattern</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Practice reading words ending in <strong>-eng</strong>:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div id="student-name-prompt" class="section" style="display:none;">
        <h2>üë§ Your Name</h2>
        <div id="name-display"></div>
        <input type="text" id="student-name" placeholder="Enter your name" maxlength="30"
          style="padding:0.5rem;font-size:1rem;width:100%;margin:0.5rem 0;display:none;">
        <div id="name-buttons"></div>
      </div>

      <div class="quiz" id="quiz-container" style="display:none;">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';
      window.startTime = Date.now();

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      const currentChapter = 73; // chapter-73.html = Lesson 74
      const maxChapter = 261;
      const WHATSAPP_NUMBER = "233257320201";

      const CHAPTER_CONFIG = {
        title: "Lesson 74: -eng Pattern with /eng/ Sound",
        loTags: ["LO PH74: Decode and use words with the /eng/ pattern"],
        contentWords: [
          "length", "strength"
        ],
        sentences: [
          "The ox had the strength of ten men.",
          "Clint had strength and did not quit.",
          "Scott can swim the length of the pond.",
          "Greg cut one inch from the length of the shelf.",
          "Pam can spell well, but math is not her strength.",
          "The slot in the box was one inch in width and six in length."
        ],
        assessmentItems: [
          { id: "1", prompt: "How many unique '-eng' words are in Lesson 74?", options: [
            {id:"a",text:"1",is_correct:false},
            {id:"b",text:"2",is_correct:true},
            {id:"c",text:"3",is_correct:false},
            {id:"d",text:"0",is_correct:false}
          ]},
          { id: "2", prompt: "Which word means 'physical power or force'?", options: [
            {id:"a",text:"length",is_correct:false},
            {id:"b",text:"strength",is_correct:true},
            {id:"c",text:"width",is_correct:false},
            {id:"d",text:"pond",is_correct:false}
          ]},
          { id: "3", prompt: "What does 'length' measure?", options: [
            {id:"a",text:"Height from top to bottom",is_correct:false},
            {id:"b",text:"Distance from end to end",is_correct:true},
            {id:"c",text:"Weight or mass",is_correct:false},
            {id:"d",text:"Volume",is_correct:false}
          ]},
          { id: "4", prompt: "Which sentence mentions an animal known for its power?", options: [
            {id:"a",text:"Sentence 1",is_correct:true},
            {id:"b",text:"Sentence 2",is_correct:false},
            {id:"c",text:"Sentence 3",is_correct:false},
            {id:"d",text:"Sentence 6",is_correct:false}
          ]},
          { id: "5", prompt: "Which character appears in multiple past lessons?", options: [
            {id:"a",text:"Scott",is_correct:true},
            {id:"b",text:"Clint",is_correct:true},
            {id:"c",text:"Greg",is_correct:false},
            {id:"d",text:"Pam",is_correct:false}
          ]},
          // Choose the recurring character
          { id: "5", prompt: "Which character appeared in Lessons 61, 66, and 70?", options: [
            {id:"a",text:"Scott",is_correct:true},
            {id:"b",text:"Clint",is_correct:false},
            {id:"c",text:"Greg",is_correct:false},
            {id:"d",text:"Pam",is_correct:false}
          ]},
          { id: "6", prompt: "Which sentence describes a personal quality beyond academics?", options: [
            {id:"a",text:"Sentence 5",is_correct:true},
            {id:"b",text:"Sentence 2",is_correct:true}
          ]},
          // Revise to one correct option
          { id: "6", prompt: "In sentence 5, what subject is NOT Pam's strength?", options: [
            {id:"a",text:"Spelling",is_correct:false},
            {id:"b",text:"Math",is_correct:true},
            {id:"c",text:"Reading",is_correct:false},
            {id:"d",text:"Writing",is_correct:false}
          ]},
          { id: "7", prompt: "Which word includes the consonant blend 'str'?", options: [
            {id:"a",text:"length",is_correct:false},
            {id:"b",text:"strength",is_correct:true},
            {id:"c",text:"width",is_correct:false},
            {id:"d",text:"shelf",is_correct:false}
          ]},
          { id: "8", prompt: "What action does Greg perform in sentence 4?", options: [
            {id:"a",text:"Measures length",is_correct:false},
            {id:"b",text:"Cuts the shelf",is_correct:true},
            {id:"c",text:"Swims across",is_correct:false},
            {id:"d",text:"Lifts an ox",is_correct:false}
          ]},
          { id: "9", prompt: "Which sentence includes a comparison of dimensions?", options: [
            {id:"a",text:"Sentence 6",is_correct:true},
            {id:"b",text:"Sentence 1",is_correct:false},
            {id:"c",text:"Sentence 3",is_correct:false},
            {id:"d",text:"Sentence 2",is_correct:false}
          ]},
          { id: "10", prompt: "What sound does '-eng' represent?", options: [
            {id:"a",text:"/…õn…°/",is_correct:true},
            {id:"b",text:"/√¶≈ã/",is_correct:false},
            {id:"c",text:"/…™≈ã/",is_correct:false},
            {id:"d",text:"/ å≈ãk/",is_correct:false}
          ]},
          { id: "11", prompt: "Which sentence shows perseverance?", options: [
            {id:"a",text:"Sentence 2",is_correct:true},
            {id:"b",text:"Sentence 1",is_correct:false},
            {id:"c",text:"Sentence 4",is_correct:false},
            {id:"d",text:"Sentence 6",is_correct:false}
          ]},
          { id: "12", prompt: "Which word is used THREE times in the sentences?", options: [
            {id:"a",text:"length",is_correct:true},
            {id:"b",text:"strength",is_correct:true}
          ]},
          // Fix: only one correct based on count
          { id: "12", prompt: "How many times does 'length' appear in the sentences?", options: [
            {id:"a",text:"1",is_correct:false},
            {id:"b",text:"2",is_correct:false},
            {id:"c",text:"3",is_correct:true},
            {id:"d",text:"4",is_correct:false}
          ]},
          { id: "13", prompt: "How many times does 'strength' appear?", options: [
            {id:"a",text:"1",is_correct:false},
            {id:"b",text:"2",is_correct:false},
            {id:"c",text:"3",is_correct:true},
            {id:"d",text:"0",is_correct:false}
          ]},
          { id: "14", prompt: "Which sentence includes a unit of measurement?", options: [
            {id:"a",text:"Sentence 4",is_correct:true},
            {id:"b",text:"Sentence 1",is_correct:false},
            {id:"c",text:"Sentence 2",is_correct:false},
            {id:"d",text:"Sentence 5",is_correct:false}
          ]},
          { id: "15", prompt: "Which word is NOT in the Lesson 74 word list?", options: [
            {id:"a",text:"length",is_correct:false},
            {id:"b",text:"strength",is_correct:false},
            {id:"c",text:"peck",is_correct:true},
            {id:"d",text:"All of the above are in the list",is_correct:false}
          ]},
          { id: "16", prompt: "Which phrase uses an '-eng' word correctly?", options: [
            {id:"a",text:"She has great strength.",is_correct:true},
            {id:"b",text:"He ate a big length for lunch.",is_correct:false},
            {id:"c",text:"They drove a strength to school.",is_correct:false},
            {id:"d",text:"The dog gave a length of joy.",is_correct:false}
          ]},
          { id: "17", prompt: "Which sentence involves water?", options: [
            {id:"a",text:"Sentence 3",is_correct:true},
            {id:"b",text:"Sentence 1",is_correct:false},
            {id:"c",text:"Sentence 4",is_correct:false},
            {id:"d",text:"Sentence 6",is_correct:false}
          ]},
          { id: "18", prompt: "What is the structure of the '-eng' pattern?", options: [
            {id:"a",text:"Vowel + 'ng'",is_correct:false},
            {id:"b",text:"Vowel + 'nk'",is_correct:false},
            {id:"c",text:"Vowel + 'eng' (e + ng)",is_correct:true},
            {id:"d",text:"Consonant + 'eng'",is_correct:false}
          ]},
          { id: "19", prompt: "Which sentence contrasts two academic skills?", options: [
            {id:"a",text:"Sentence 5",is_correct:true},
            {id:"b",text:"Sentence 2",is_correct:false},
            {id:"c",text:"Sentence 6",is_correct:false},
            {id:"d",text:"Sentence 1",is_correct:false}
          ]},
          { id: "20", prompt: "Which spelling pattern is the focus of Lesson 74?", options: [
            {id:"a",text:"-ang",is_correct:false},
            {id:"b",text:"-ing",is_correct:false},
            {id:"c",text:"-eng",is_correct:true},
            {id:"d",text:"-ong",is_correct:false}
          ]}
        ]
      };

      function renderWords() {
        document.getElementById('word-list').innerHTML =
          CHAPTER_CONFIG.contentWords.map(w => `<span class="word-item">${w}</span>`).join('');
      }

      function renderSentences() {
        let sentences = CHAPTER_CONFIG.sentences.map(s => 
          s.replace(/f resh/g, 'fresh')
           .replace(/p unch/g, 'punch')
           .replace(/slep t/g, 'slept')
           .replace(/crep t/g, 'crept')
           .replace(/p lant/g, 'plant')
           // No typos in this PDF
        );
        document.getElementById('sentences').innerHTML =
          sentences.map(s => `<p>${s}</p>`).join('');
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [{ label: "Home", url: "../index.html", active: false }];
        for (let i = 0; i < 4; i++) {
          const c = currentChapter + i;
          const lessonNum = c + 1;
          if (c > maxChapter) break;
          buttons.push({ 
            label: `Lesson ${lessonNum}`, 
            url: `chapter-${c}.html`, 
            active: i === 0 
          });
        }
        nav.innerHTML = buttons.map(b => 
          `<a href="${b.url}" class="chapter-btn ${b.active ? 'active' : ''}">${b.label}</a>`
        ).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};
        form.innerHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          const opts = shuffle([...q.options]);
          const correct = q.options.find(o => o.is_correct);
          window.quizCorrectMap[q.id] = correct.id;
          const optHtml = opts.map((o, i) => {
            const L = String.fromCharCode(65 + i);
            return `<div class="option"><label><input type="radio" name="q${q.id}" value="${o.id}" required> ${L}. ${o.text}</label></div>`;
          }).join('');
          return `<div class="question"><strong>${q.id}. ${q.prompt}</strong><div class="options">${optHtml}</div></div>`;
        }).join('');
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0, correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const ans = answers[i];
          const correctId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctId);
          const isCorrect = ans === correctId;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt} ‚Üí ‚úÖ ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt} ‚Üí ‚ùå Your answer: ${item.options.find(o => o.id === ans)?.text || '‚Äî'} | ‚úÖ ${correctOpt.text}`);
          }
        });

        const score = correctCount, total = 20, mastery = score >= 15;
        const timeOnTask = Math.floor((Date.now() - window.startTime) / 1000);
        const attemptsKey = `quiz_attempts_${currentChapter}`;
        const attempts = (parseInt(localStorage.getItem(attemptsKey)) || 0) + 1;
        localStorage.setItem(attemptsKey, attempts);
        localStorage.setItem(`mastery_${currentChapter}`, mastery ? '1' : '0');
        const studentName = localStorage.getItem('student_name') || '[Name]';

        let report = `*Mini OpenStax ‚Äî ${CHAPTER_CONFIG.title}*\nStudent: ${studentName}\nScore: ${score}/${total} (${Math.round(score/total*100)}%) ‚Äî ${mastery ? '‚úÖ MASTERED' : '‚ùå Needs Review'}\nTime: ${timeOnTask}s | Attempts: ${attempts}\n\n`;
        if (correctList.length) report += `‚úÖ CORRECT (${correctList.length}):\n${correctList.join('\n')}\n\n`;
        if (incorrectList.length) report += `‚ùå INCORRECT (${incorrectList.length}):\n${incorrectList.join('\n')}\n\n`;
        report += `Report generated via Mini OpenStax.`;

        const reportKey = `saved_report_${currentChapter}_${Date.now()}`;
        localStorage.setItem(reportKey, report);

        const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(report)}`;
        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}/${total}</h3>
            <p><strong>${mastery ? 'üéâ Excellent!' : score >= 10 ? 'Good!' : 'Keep practicing.'}</strong> ${
              mastery ? 'You‚Äôve mastered the /eng/ pattern!' :
              score >= 10 ? 'Review missed items.' : 'Practice this lesson again.'
            }</p>
            <p><strong>Time:</strong> ${timeOnTask}s | <strong>Attempts:</strong> ${attempts}</p>
            <a href="${url}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">
              üì≤ Send Report via WhatsApp
            </a>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const el = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(el ? el.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function initNamePrompt() {
        const saved = localStorage.getItem('student_name');
        const promptDiv = document.getElementById('student-name-prompt');
        const quizDiv = document.getElementById('quiz-container');
        const display = document.getElementById('name-display');
        const input = document.getElementById('student-name');
        const buttons = document.getElementById('name-buttons');

        if (saved) {
          promptDiv.style.display = 'block';
          quizDiv.style.display = 'none';
          display.innerHTML = `<p><strong>Current name:</strong> ${saved}</p>`;
          buttons.innerHTML = `
            <button type="button" class="btn" id="keep-btn">‚úÖ Keep This Name</button>
            <button type="button" class="btn btn-secondary" id="change-btn">‚úèÔ∏è Use a Different Name</button>
          `;
          document.getElementById('keep-btn').onclick = () => {
            promptDiv.style.display = 'none';
            quizDiv.style.display = 'block';
          };
          document.getElementById('change-btn').onclick = () => {
            display.style.display = 'none';
            input.style.display = 'block';
            buttons.innerHTML = `<button type="button" class="btn" id="save-new">üíæ Save and Start Quiz</button>`;
            input.value = '';
            input.focus();
            document.getElementById('save-new').onclick = saveName;
          };
        } else {
          promptDiv.style.display = 'block';
          quizDiv.style.display = 'none';
          display.style.display = 'none';
          input.style.display = 'block';
          buttons.innerHTML = `<button type="button" class="btn" id="save-first">üíæ Save and Start Quiz</button>`;
          document.getElementById('save-first').onclick = saveName;
        }

        function saveName() {
          const name = input.value.trim();
          if (name) {
            localStorage.setItem('student_name', name);
            promptDiv.style.display = 'none';
            quizDiv.style.display = 'block';
          } else {
            alert("Please enter your name.");
            input.focus();
          }
        }
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
        initNamePrompt();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
