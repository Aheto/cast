<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 217 ‚Äî R-Controlled or = /√¥r/"/>
  <title>Mini OpenStax ‚Äî Lesson 217: or = /√¥r/</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn { background: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
    .btn:hover { background: #218838; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 217: or = /√¥r/</h1>
        <div class="lo-tags" id="lo-tags">LO PH217: Decode words with r-controlled or = /√¥r/</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Words with the <strong>r-controlled</strong> <em>or</em> making the <strong>/√¥r/</strong> sound:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud. All words are decodable from Lessons 2‚Äì217:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div class="quiz" id="quiz-container">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      const currentChapter = 216;   // chapter-216.html = Lesson 217
      const maxChapter = 261;

      const CHAPTER_CONFIG = {
        title: "Lesson 217: or = /√¥r/",
        loTags: ["LO PH217: Decode words with r-controlled or = /√¥r/"],
        contentWords: [
          "fort", "port", "sport", "sort", "short",
          "fork", "cork", "pork",
          "born", "corn", "horn", "worn", "thorn",
          "form", "storm", "cord", "lord", "ford",
          "porch", "torch", "north", "horse", "force"
        ],
        sentences: [
          "A midget is a very short person.",
          "To apply for the job, Kay must fill out a form.",
          "Your birthday is the date on which you were born.",
          "The army tried to defend the fort from an enemy attack.",
          "The fierce storm from the north will rage with great force.",
          "In the late summer, the farmer will harvest his crop of corn.",
          "The cowboy will saddle up his horse and ride off into the sunset.",
          "The meat department at the grocery store has beef, pork, fish and poultry."
        ],
        whatsappNumber: "233257320201",
        assessmentItems: [
          { id: "1", prompt: "Which word contains 'or' making /√¥r/?", options: [{id:"a",text:"fort",is_correct:true},{id:"b",text:"fat",is_correct:false},{id:"c",text:"fit",is_correct:false},{id:"d",text:"fun",is_correct:false}] },
          { id: "2", prompt: "Which is NOT a Lesson 217 word?", options: [{id:"a",text:"horse",is_correct:false},{id:"b",text:"force",is_correct:false},{id:"c",text:"door",is_correct:true},{id:"d",text:"corn",is_correct:false}] },
          { id: "3", prompt: "In 'storm', what sound does 'or' make?", options: [{id:"a",text:"/√¥r/",is_correct:true},{id:"b",text:"/√§r/",is_correct:false},{id:"c",text:"/…ôr/",is_correct:false},{id:"d",text:"/≈ç/",is_correct:false}] },
          { id: "4", prompt: "Which word means 'a military stronghold'?", options: [{id:"a",text:"fort",is_correct:true},{id:"b",text:"port",is_correct:false},{id:"c",text:"sport",is_correct:false},{id:"d",text:"sort",is_correct:false}] },
          { id: "5", prompt: "How many letters in 'thorn'?", options: [{id:"a",text:"5",is_correct:true},{id:"b",text:"4",is_correct:false},{id:"c",text:"6",is_correct:false},{id:"d",text:"3",is_correct:false}] },
          { id: "6", prompt: "Which sentence uses only Lesson 217 words?", options: [{id:"a",text:"In the late summer, the farmer will harvest his crop of corn.",is_correct:true},{id:"b",text:"She sat on a mat.",is_correct:false},{id:"c",text:"He ran fast.",is_correct:false},{id:"d",text:"They played ball.",is_correct:false}] },
          { id: "7", prompt: "Which word refers to a large animal used for riding?", options: [{id:"a",text:"horse",is_correct:true},{id:"b",text:"horn",is_correct:false},{id:"c",text:"torch",is_correct:false},{id:"d",text:"cord",is_correct:false}] },
          { id: "8", prompt: "What syllable type is in 'force'?", options: [{id:"a",text:"R-controlled",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Open syllable",is_correct:false},{id:"d",text:"Closed syllable",is_correct:false}] },
          { id: "9", prompt: "In 'The fierce storm from the north will rage with great force,' how many Lesson 217 words?", options: [{id:"a",text:"4",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"1",is_correct:false},{id:"d",text:"3",is_correct:false}] },
          { id: "10", prompt: "Which word means 'the direction opposite of south'?", options: [{id:"a",text:"north",is_correct:true},{id:"b",text:"ford",is_correct:false},{id:"c",text:"lord",is_correct:false},{id:"d",text:"porch",is_correct:false}] },
          { id: "11", prompt: "Which word describes someone not tall?", options: [{id:"a",text:"short",is_correct:true},{id:"b",text:"worn",is_correct:false},{id:"c",text:"born",is_correct:false},{id:"d",text:"form",is_correct:false}] },
          { id: "12", prompt: "Which word ends with 'or' and means 'a type of meat from pigs'?", options: [{id:"a",text:"pork",is_correct:true},{id:"b",text:"fork",is_correct:false},{id:"c",text:"cork",is_correct:false},{id:"d",text:"sport",is_correct:false}] },
          { id: "13", prompt: "Which sentence is from Lesson 217?", options: [{id:"a",text:"The cowboy will saddle up his horse and ride off into the sunset.",is_correct:true},{id:"b",text:"She likes apples.",is_correct:false},{id:"c",text:"He jumped high.",is_correct:false},{id:"d",text:"They walked home.",is_correct:false}] },
          { id: "14", prompt: "How many consonants in 'torch'?", options: [{id:"a",text:"4",is_correct:true},{id:"b",text:"3",is_correct:false},{id:"c",text:"5",is_correct:false},{id:"d",text:"2",is_correct:false}] },
          { id: "15", prompt: "Which word means 'a document to be filled out'?", options: [{id:"a",text:"form",is_correct:true},{id:"b",text:"fort",is_correct:false},{id:"c",text:"fork",is_correct:false},{id:"d",text:"force",is_correct:false}] },
          { id: "16", prompt: "What phonics pattern is in 'horn'?", options: [{id:"a",text:"R-controlled or = /√¥r/",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Closed syllable",is_correct:false},{id:"d",text:"Vowel team 'ow'",is_correct:false}] },
          { id: "17", prompt: "Which word refers to maize, a common crop?", options: [{id:"a",text:"corn",is_correct:true},{id:"b",text:"cord",is_correct:false},{id:"c",text:"ford",is_correct:false},{id:"d",text:"lord",is_correct:false}] },
          { id: "18", prompt: "Which word might complete: 'Don‚Äôt stick a metal ___ in the toaster.'?", options: [{id:"a",text:"fork",is_correct:true},{id:"b",text:"pork",is_correct:false},{id:"c",text:"cork",is_correct:false},{id:"d",text:"port",is_correct:false}] },
          { id: "19", prompt: "Which word appears in both the word list and sentences?", options: [{id:"a",text:"short",is_correct:true},{id:"b",text:"born",is_correct:true},{id:"c",text:"horse",is_correct:true},{id:"d",text:"All of the above",is_correct:true}] },
          { id: "20", prompt: "What phonics concept is taught in Lesson 217?", options: [{id:"a",text:"R-controlled or = /√¥r/",is_correct:true},{id:"b",text:"Split vowel pairs",is_correct:false},{id:"c",text:"Magic E",is_correct:false},{id:"d",text:"Vowel teams",is_correct:false}] }
        ]
      };

      function renderWords() {
        const container = document.getElementById('word-list');
        container.innerHTML = CHAPTER_CONFIG.contentWords.map(word =>
          `<span class="word-item">${word}</span>`
        ).join('');
      }

      function renderSentences() {
        const container = document.getElementById('sentences');
        container.innerHTML = CHAPTER_CONFIG.sentences.map(s =>
          `<p>${s}</p>`
        ).join('');
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [];
        buttons.push({ label: "Home", url: "../index.html", active: false });
        for (let i = 0; i < 4; i++) {
          const chapterNum = currentChapter + i;
          if (chapterNum > maxChapter) break;
          const lessonNum = chapterNum + 1;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${chapterNum}.html`,
            active: (i === 0)
          });
        }
        nav.innerHTML = buttons.map(btn => `
          <a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">
            ${btn.label}
          </a>
        `).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};

        const quizHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          let shuffledOptions = [...q.options];
          shuffle(shuffledOptions);

          const correctOpt = q.options.find(opt => opt.is_correct);
          window.quizCorrectMap[q.id] = correctOpt.id;

          const optionsHTML = shuffledOptions.map((opt, idx) => {
            const label = String.fromCharCode(97 + idx).toUpperCase();
            return `
              <div class="option">
                <label>
                  <input type="radio" name="q${q.id}" value="${opt.id}" required> ${label}. ${opt.text}
                </label>
              </div>
            `;
          }).join('');

          return `
            <div class="question">
              <strong>${q.id}. ${q.prompt}</strong>
              <div class="options">
                ${optionsHTML}
              </div>
            </div>
          `;
        }).join('');

        form.innerHTML = quizHTML;
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0;
        let correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const userAns = answers[i];
          const correctOptId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctOptId);
          const isCorrect = userAns === correctOptId;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt}\n   ‚úÖ Correct: ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt}\n   ‚ùå You chose: ${item.options.find(o => o.id === userAns)?.text || '‚Äî'}\n   ‚úÖ Correct: ${correctOpt.text}`);
          }
        });

        const score = `${correctCount}/20}`;
        const summary = `*Mini OpenStax ‚Äî Phonics Lesson 217*\nStudent: [Name]\nScore: ${score}\n\n`;
        const correctStr = correctList.length ? '‚úÖ CORRECT:\n' + correctList.join('\n\n') + '\n\n' : '';
        const incorrectStr = incorrectList.length ? '‚ùå INCORRECT:\n' + incorrectList.join('\n\n') : '';
        const message = encodeURIComponent(summary + correctStr + incorrectStr + `\nReport generated via Mini OpenStax. Share with instructor: https://wa.me/${CHAPTER_CONFIG.whatsappNumber}`);
        const whatsappLink = `https://wa.me/${CHAPTER_CONFIG.whatsappNumber}?text=${message}`;

        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}</h3>
            <p><strong>${correctCount >= 15 ? 'Excellent! You‚Äôve mastered r-controlled or=/√¥r/!' : correctCount >= 10 ? 'Good! Review missed items.' : 'Practice Lesson 217 words again.'}</strong></p>
            <p><a href="${whatsappLink}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report to Instructor</a></p>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const selected = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(selected ? selected.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
