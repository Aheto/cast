<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 218 ‚Äî R-Controlled or = /√¥r/"/>
  <title>Mini OpenStax ‚Äî Lesson 218: or = /√¥r/</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn { background: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
    .btn:hover { background: #218838; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 218: or = /√¥r/</h1>
        <div class="lo-tags" id="lo-tags">LO PH218: Decode words with r-controlled or = /√¥r/</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Words with the <strong>r-controlled</strong> <em>or</em> making the <strong>/√¥r/</strong> sound:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud. All words are decodable from Lessons 2‚Äì218:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div class="quiz" id="quiz-container">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      const currentChapter = 217;   // chapter-217.html = Lesson 218
      const maxChapter = 261;

      const CHAPTER_CONFIG = {
        title: "Lesson 218: or = /√¥r/",
        loTags: ["LO PH218: Decode words with r-controlled or = /√¥r/"],
        contentWords: [
          "order", "border", "corner", "morning", "forest", "normal", "glory", "story", "orange", "horrible",
          "correct", "forget", "forgive", "forever", "perform", "platform", "uniform", "record", "favorite",
          "export", "import", "airport", "report", "support", "important", "history", "victory", "territory"
        ],
        sentences: [
          "Bert is reading an interesting story.",
          "Judy can pour a glass of orange juice for herself.",
          "Martin thinks that history is his favorite subject.",
          "Jane tries to follow the motto,\"Forgive and forget\".",
          "The city has an important airport near its north border.",
          "In the forest, Mike saw a rabbit, a squirrel and a deer.",
          "At the circus, the clown will perform magic tricks to entertain the crowd.",
          "The man must salute and say\"Yes Sir!\" when the general gives him an order."
        ],
        whatsappNumber: "233257320201",
        assessmentItems: [
          { id: "1", prompt: "Which word contains 'or' making /√¥r/?", options: [{id:"a",text:"order",is_correct:true},{id:"b",text:"open",is_correct:false},{id:"c",text:"oven",is_correct:false},{id:"d",text:"over",is_correct:false}] },
          { id: "2", prompt: "Which is NOT a Lesson 218 word?", options: [{id:"a",text:"history",is_correct:false},{id:"b",text:"orange",is_correct:false},{id:"c",text:"doctor",is_correct:true},{id:"d",text:"forest",is_correct:false}] },
          { id: "3", prompt: "In 'morning', what sound does 'or' make?", options: [{id:"a",text:"/√¥r/",is_correct:true},{id:"b",text:"/√§r/",is_correct:false},{id:"c",text:"/…ôr/",is_correct:false},{id:"d",text:"/≈ç/",is_correct:false}] },
          { id: "4", prompt: "Which word means 'a series of events, real or imagined, told for entertainment'?", options: [{id:"a",text:"story",is_correct:true},{id:"b",text:"glory",is_correct:false},{id:"c",text:"corner",is_correct:false},{id:"d",text:"border",is_correct:false}] },
          { id: "5", prompt: "How many letters in 'favorite'?", options: [{id:"a",text:"7",is_correct:true},{id:"b",text:"6",is_correct:false},{id:"c",text:"8",is_correct:false},{id:"d",text:"5",is_correct:false}] },
          { id: "6", prompt: "Which sentence uses only Lesson 218 words?", options: [{id:"a",text:"Bert is reading an interesting story.",is_correct:true},{id:"b",text:"She sat on a mat.",is_correct:false},{id:"c",text:"He ran fast.",is_correct:false},{id:"d",text:"They played ball.",is_correct:false}] },
          { id: "7", prompt: "Which word refers to a large wooded area?", options: [{id:"a",text:"forest",is_correct:true},{id:"b",text:"morning",is_correct:false},{id:"c",text:"platform",is_correct:false},{id:"d",text:"uniform",is_correct:false}] },
          { id: "8", prompt: "What syllable type is in 'perform'?", options: [{id:"a",text:"R-controlled",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Open syllable",is_correct:false},{id:"d",text:"Closed syllable",is_correct:false}] },
          { id: "9", prompt: "In 'The city has an important airport near its north border,' how many Lesson 218 words?", options: [{id:"a",text:"4",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"1",is_correct:false},{id:"d",text:"3",is_correct:false}] },
          { id: "10", prompt: "Which word means 'to carry out an action, especially before an audience'?", options: [{id:"a",text:"perform",is_correct:true},{id:"b",text:"record",is_correct:false},{id:"c",text:"support",is_correct:false},{id:"d",text:"export",is_correct:false}] },
          { id: "11", prompt: "Which word describes the time of day after sunrise?", options: [{id:"a",text:"morning",is_correct:true},{id:"b",text:"orange",is_correct:false},{id:"c",text:"history",is_correct:false},{id:"d",text:"victory",is_correct:false}] },
          { id: "12", prompt: "Which word ends with 'or' and means 'a command or instruction from an authority'?", options: [{id:"a",text:"order",is_correct:true},{id:"b",text:"border",is_correct:false},{id:"c",text:"corner",is_correct:false},{id:"d",text:"territory",is_correct:false}] },
          { id: "13", prompt: "Which sentence is from Lesson 218?", options: [{id:"a",text:"At the circus, the clown will perform magic tricks to entertain the crowd.",is_correct:true},{id:"b",text:"She likes apples.",is_correct:false},{id:"c",text:"He jumped high.",is_correct:false},{id:"d",text:"They walked home.",is_correct:false}] },
          { id: "14", prompt: "How many consonants in 'victory'?", options: [{id:"a",text:"5",is_correct:true},{id:"b",text:"4",is_correct:false},{id:"c",text:"6",is_correct:false},{id:"d",text:"3",is_correct:false}] },
          { id: "15", prompt: "Which word means 'most liked or preferred'?", options: [{id:"a",text:"favorite",is_correct:true},{id:"b",text:"normal",is_correct:false},{id:"c",text:"horrible",is_correct:false},{id:"d",text:"glory",is_correct:false}] },
          { id: "16", prompt: "What phonics pattern is in 'airport'?", options: [{id:"a",text:"R-controlled or = /√¥r/",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Closed syllable",is_correct:false},{id:"d",text:"Vowel team 'ie'",is_correct:false}] },
          { id: "17", prompt: "Which word refers to the study of past events?", options: [{id:"a",text:"history",is_correct:true},{id:"b",text:"territory",is_correct:false},{id:"c",text:"platform",is_correct:false},{id:"d",text:"uniform",is_correct:false}] },
          { id: "18", prompt: "Which word might complete: 'Please don‚Äôt ___ what I said.'?", options: [{id:"a",text:"forget",is_correct:true},{id:"b",text:"order",is_correct:false},{id:"c",text:"perform",is_correct:false},{id:"d",text:"support",is_correct:false}] },
          { id: "19", prompt: "Which word appears in both the word list and sentences?", options: [{id:"a",text:"story",is_correct:true},{id:"b",text:"orange",is_correct:true},{id:"c",text:"history",is_correct:true},{id:"d",text:"All of the above",is_correct:true}] },
          { id: "20", prompt: "What phonics concept is taught in Lesson 218?", options: [{id:"a",text:"R-controlled or = /√¥r/",is_correct:true},{id:"b",text:"Split vowel pairs",is_correct:false},{id:"c",text:"Magic E",is_correct:false},{id:"d",text:"Vowel teams",is_correct:false}] }
        ]
      };

      function renderWords() {
        const container = document.getElementById('word-list');
        container.innerHTML = CHAPTER_CONFIG.contentWords.map(word =>
          `<span class="word-item">${word}</span>`
        ).join('');
      }

      function renderSentences() {
        const container = document.getElementById('sentences');
        container.innerHTML = CHAPTER_CONFIG.sentences.map(s =>
          `<p>${s}</p>`
        ).join('');
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [];
        buttons.push({ label: "Home", url: "../index.html", active: false });
        for (let i = 0; i < 4; i++) {
          const chapterNum = currentChapter + i;
          if (chapterNum > maxChapter) break;
          const lessonNum = chapterNum + 1;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${chapterNum}.html`,
            active: (i === 0)
          });
        }
        nav.innerHTML = buttons.map(btn => `
          <a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">
            ${btn.label}
          </a>
        `).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};

        const quizHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          let shuffledOptions = [...q.options];
          shuffle(shuffledOptions);

          const correctOpt = q.options.find(opt => opt.is_correct);
          window.quizCorrectMap[q.id] = correctOpt.id;

          const optionsHTML = shuffledOptions.map((opt, idx) => {
            const label = String.fromCharCode(97 + idx).toUpperCase();
            return `
              <div class="option">
                <label>
                  <input type="radio" name="q${q.id}" value="${opt.id}" required> ${label}. ${opt.text}
                </label>
              </div>
            `;
          }).join('');

          return `
            <div class="question">
              <strong>${q.id}. ${q.prompt}</strong>
              <div class="options">
                ${optionsHTML}
              </div>
            </div>
          `;
        }).join('');

        form.innerHTML = quizHTML;
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0;
        let correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const userAns = answers[i];
          const correctOptId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctOptId);
          const isCorrect = userAns === correctOptId;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt}\n   ‚úÖ Correct: ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt}\n   ‚ùå You chose: ${item.options.find(o => o.id === userAns)?.text || '‚Äî'}\n   ‚úÖ Correct: ${correctOpt.text}`);
          }
        });

        const score = `${correctCount}/20}`;
        const summary = `*Mini OpenStax ‚Äî Phonics Lesson 218*\nStudent: [Name]\nScore: ${score}\n\n`;
        const correctStr = correctList.length ? '‚úÖ CORRECT:\n' + correctList.join('\n\n') + '\n\n' : '';
        const incorrectStr = incorrectList.length ? '‚ùå INCORRECT:\n' + incorrectList.join('\n\n') : '';
        const message = encodeURIComponent(summary + correctStr + incorrectStr + `\nReport generated via Mini OpenStax. Share with instructor: https://wa.me/${CHAPTER_CONFIG.whatsappNumber}`);
        const whatsappLink = `https://wa.me/${CHAPTER_CONFIG.whatsappNumber}?text=${message}`;

        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}</h3>
            <p><strong>${correctCount >= 15 ? 'Excellent! You‚Äôve mastered r-controlled or=/√¥r/!' : correctCount >= 10 ? 'Good! Review missed items.' : 'Practice Lesson 218 words again.'}</strong></p>
            <p><a href="${whatsappLink}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report to Instructor</a></p>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const selected = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(selected ? selected.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
