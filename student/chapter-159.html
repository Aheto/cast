<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 160 ‚Äî Magic E Syllables (a=/ƒÅ/)"/>
  <title>Mini OpenStax ‚Äî Lesson 160: Magic E (a=/ƒÅ/)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn { background: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
    .btn:hover { background: #218838; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 160: Magic E (a=/ƒÅ/)</h1>
        <div class="lo-tags" id="lo-tags">LO PH160: Decode words with Magic E pattern (a = /ƒÅ/)</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <!-- üìö 5-BUTTON NAVIGATION BAR (Home + current + next 3 lessons) -->
    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Words with the <strong>Magic E</strong> pattern where <em>a = /ƒÅ/</em> (long a):</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud. All words are decodable from Lessons 2‚Äì160:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div class="quiz" id="quiz-container">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';

      const currentChapter = 159;   // chapter-159.html = Lesson 160
      const maxChapter = 261;       // Ultimate Phonics has 262 lessons ‚Üí chapters 0‚Äì261

      const CHAPTER_CONFIG = {
        title: "Lesson 160: Magic E (a=/ƒÅ/)",
        loTags: ["LO PH160: Decode words with Magic E pattern (a = /ƒÅ/)"],
        contentWords: [
          "bare", "care", "dare", "fare", "hare", "mare", "rare", "flare", "glare", "scare", "stare", "share", "square", "aware", "compare"
        ],
        sentences: [
          "Nancy found a rare silver coin.",
          "Jane needs bus fare to travel on the bus.",
          "The glare from the hot sun made Clint squint.",
          "The little boy ran around the house in bare feet.",
          "The growl from the puppy didn't scare the brave kitten.",
          "The selfish boy won't share anything with the other children.",
          "The cowboy let Jack saddle up the gray mare for a gallop around the ranch."
        ],
        whatsappNumber: "233257320201",
        assessmentItems: [
          { id: "1", prompt: "Which word uses the Magic E pattern with a=/ƒÅ/?", options: [{id:"a",text:"care",is_correct:true},{id:"b",text:"cat",is_correct:false},{id:"c",text:"cap",is_correct:false},{id:"d",text:"can",is_correct:false}] },
          { id: "2", prompt: "Which is NOT a Lesson 160 word?", options: [{id:"a",text:"stare",is_correct:false},{id:"b",text:"square",is_correct:false},{id:"c",text:"crare",is_correct:true},{id:"d",text:"flare",is_correct:false}] },
          { id: "3", prompt: "What sound does 'a' make in 'dare'?", options: [{id:"a",text:"/ƒÉ/",is_correct:false},{id:"b",text:"/ƒÅ/",is_correct:true},{id:"c",text:"/√§/",is_correct:false},{id:"d",text:"/e/",is_correct:false}] },
          { id: "4", prompt: "Which word means 'to look fixedly'?", options: [{id:"a",text:"stare",is_correct:true},{id:"b",text:"share",is_correct:false},{id:"c",text:"flare",is_correct:false},{id:"d",text:"mare",is_correct:false}] },
          { id: "5", prompt: "How many letters in 'compare'?", options: [{id:"a",text:"7",is_correct:true},{id:"b",text:"6",is_correct:false},{id:"c",text:"8",is_correct:false},{id:"d",text:"5",is_correct:false}] },
          { id: "6", prompt: "Which sentence uses only Lesson 160 words?", options: [{id:"a",text:"Nancy found a rare silver coin.",is_correct:true},{id:"b",text:"Tom sat on a mat.",is_correct:false},{id:"c",text:"She ran fast.",is_correct:false},{id:"d",text:"He had a dog.",is_correct:false}] },
          { id: "7", prompt: "Which word means 'payment for a ride'?", options: [{id:"a",text:"fare",is_correct:true},{id:"b",text:"care",is_correct:false},{id:"c",text:"dare",is_correct:false},{id:"d",text:"hare",is_correct:false}] },
          { id: "8", prompt: "What makes the 'a' long in 'bare'?", options: [{id:"a",text:"Silent e",is_correct:true},{id:"b",text:"Double a",is_correct:false},{id:"c",text:"It's open",is_correct:false},{id:"d",text:"R-controlled",is_correct:false}] },
          { id: "9", prompt: "In 'The glare from the hot sun made Clint squint,' how many Lesson 160 words?", options: [{id:"a",text:"1",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"0",is_correct:false},{id:"d",text:"3",is_correct:false}] },
          { id: "10", prompt: "Which word means 'to give part of something to others'?", options: [{id:"a",text:"share",is_correct:true},{id:"b",text:"scare",is_correct:false},{id:"c",text:"stare",is_correct:false},{id:"d",text:"flare",is_correct:false}] },
          { id: "11", prompt: "Which word describes a female horse?", options: [{id:"a",text:"mare",is_correct:true},{id:"b",text:"hare",is_correct:false},{id:"c",text:"rare",is_correct:false},{id:"d",text:"care",is_correct:false}] },
          { id: "12", prompt: "Which word ends with 'are' and means 'uncommon'?", options: [{id:"a",text:"rare",is_correct:true},{id:"b",text:"dare",is_correct:false},{id:"c",text:"bare",is_correct:false},{id:"d",text:"flare",is_correct:false}] },
          { id: "13", prompt: "Which sentence is from Lesson 160?", options: [{id:"a",text:"The selfish boy won't share anything with the other children.",is_correct:true},{id:"b",text:"She likes apples.",is_correct:false},{id:"c",text:"He jumped high.",is_correct:false},{id:"d",text:"They walked home.",is_correct:false}] },
          { id: "14", prompt: "How many consonants in 'square'?", options: [{id:"a",text:"3",is_correct:false},{id:"b",text:"4",is_correct:true},{id:"c",text:"5",is_correct:false},{id:"d",text:"2",is_correct:false}] },
          { id: "15", prompt: "Which word is NOT a verb?", options: [{id:"a",text:"mare",is_correct:true},{id:"b",text:"dare",is_correct:false},{id:"c",text:"share",is_correct:false},{id:"d",text:"compare",is_correct:false}] },
          { id: "16", prompt: "What syllable type is 'care'?", options: [{id:"a",text:"Closed",is_correct:false},{id:"b",text:"Open",is_correct:false},{id:"c",text:"Magic E",is_correct:true},{id:"d",text:"Vowel Team",is_correct:false}] },
          { id: "17", prompt: "Which word means 'knowing or informed'?", options: [{id:"a",text:"aware",is_correct:true},{id:"b",text:"bare",is_correct:false},{id:"c",text:"flare",is_correct:false},{id:"d",text:"glare",is_correct:false}] },
          { id: "18", prompt: "Which word might complete: 'Don't ___ to jump!'?", options: [{id:"a",text:"dare",is_correct:true},{id:"b",text:"mare",is_correct:false},{id:"c",text:"hare",is_correct:false},{id:"d",text:"fare",is_correct:false}] },
          { id: "19", prompt: "Which word appears in both Lesson 160 word list and sentences?", options: [{id:"a",text:"rare",is_correct:true},{id:"b",text:"care",is_correct:true},{id:"c",text:"mare",is_correct:true},{id:"d",text:"All of the above",is_correct:true}] },
          { id: "20", prompt: "What phonics pattern is taught in Lesson 160?", options: [{id:"a",text:"-ang",is_correct:false},{id:"b",text:"Magic E (a=/ƒÅ/)",is_correct:true},{id:"c",text:"-ink",is_correct:false},{id:"d",text:"R-controlled ar",is_correct:false}] }
        ]
      };

      // Render word list
      function renderWords() {
        const container = document.getElementById('word-list');
        container.innerHTML = CHAPTER_CONFIG.contentWords.map(word =>
          `<span class="word-item">${word}</span>`
        ).join('');
      }

      // Render sentences
      function renderSentences() {
        const container = document.getElementById('sentences');
        container.innerHTML = CHAPTER_CONFIG.sentences.map(s =>
          `<p>${s}</p>`
        ).join('');
      }

      // ‚úÖ UNLIMITED NAVIGATION
      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [];
        buttons.push({ label: "Home", url: "../index.html", active: false });
        for (let i = 0; i < 4; i++) {
          const chapterNum = currentChapter + i;
          if (chapterNum > maxChapter) break;
          const lessonNum = chapterNum + 1;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${chapterNum}.html`,
            active: (i === 0)
          });
        }
        nav.innerHTML = buttons.map(btn => `
          <a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">
            ${btn.label}
          </a>
        `).join('');
      }

      // Render quiz
      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        form.innerHTML = CHAPTER_CONFIG.assessmentItems.map(q => `
          <div class="question">
            <strong>${q.id}. ${q.prompt}</strong>
            <div class="options">
              ${q.options.map(opt => `
                <div class="option">
                  <label>
                    <input type="radio" name="q${q.id}" value="${opt.id}" required> ${opt.id.toUpperCase()}. ${opt.text}
                  </label>
                </div>
              `).join('')}
            </div>
          </div>
        `).join('');
      }

      // WhatsApp feedback
      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0;
        let correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const userAns = answers[i];
          const correctOpt = item.options.find(o => o.is_correct);
          const isCorrect = userAns === correctOpt.id;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt}\n   ‚úÖ Correct: ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt}\n   ‚ùå You chose: ${item.options.find(o => o.id === userAns)?.text || '‚Äî'}\n   ‚úÖ Correct: ${correctOpt.text}`);
          }
        });

        const score = `${correctCount}/20`;
        const summary = `*Mini OpenStax ‚Äî Phonics Lesson 160*\nStudent: [Name]\nScore: ${score}\n\n`;
        const correctStr = correctList.length ? '‚úÖ CORRECT:\n' + correctList.join('\n\n') + '\n\n' : '';
        const incorrectStr = incorrectList.length ? '‚ùå INCORRECT:\n' + incorrectList.join('\n\n') : '';
        const message = encodeURIComponent(summary + correctStr + incorrectStr + `\nReport generated via Mini OpenStax. Share with instructor: https://wa.me/${CHAPTER_CONFIG.whatsappNumber}`);
        const whatsappLink = `https://wa.me/${CHAPTER_CONFIG.whatsappNumber}?text=${message}`;

        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}</h3>
            <p><strong>${correctCount >= 15 ? 'Excellent! You‚Äôve mastered the Magic E (a=/ƒÅ/) pattern!' : correctCount >= 10 ? 'Good! Review missed items.' : 'Practice Lesson 160 words again.'}</strong></p>
            <p><a href="${whatsappLink}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report to Instructor</a></p>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const selected = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(selected ? selected.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
