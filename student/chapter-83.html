<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 84: ee Vowel Team Continued"/>
  <title>Mini OpenStax ‚Äî Lesson 84: ee Vowel Team Continued</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn {
      background: #28a745; color: white; border: none; padding: 0.5rem 1rem;
      border-radius: 4px; cursor: pointer; font-size: 1rem; margin-right: 0.5rem;
    }
    .btn:hover { background: #218838; }
    .btn-secondary { background: #6c757d; }
    .btn-secondary:hover { background: #5a6268; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 84: ee Vowel Team</h1>
        <div class="lo-tags" id="lo-tags">LO PH84: Decode and read words with the /ee/ vowel team</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Target words with the <strong>ee</strong> vowel team:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div id="student-name-prompt" class="section" style="display:none;">
        <h2>üë§ Your Name</h2>
        <div id="name-display"></div>
        <input type="text" id="student-name" placeholder="Enter your name" maxlength="30"
          style="padding:0.5rem;font-size:1rem;width:100%;margin:0.5rem 0;display:none;">
        <div id="name-buttons"></div>
      </div>

      <div class="quiz" id="quiz-container" style="display:none;">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';
      window.startTime = Date.now();

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      const currentChapter = 83; // chapter-83.html = Lesson 84
      const maxChapter = 261;
      const WHATSAPP_NUMBER = "233257320201";

      const CHAPTER_CONFIG = {
        title: "Lesson 84: ee Vowel Team",
        loTags: ["LO PH84: Decode and read words with the /ee/ vowel team"],
        contentWords: [
          "fee", "feed", "feel", "feet", "flee", "fleet", "free", "glee",
          "meek", "meet", "green", "greet", "greed", "Greek", "heel", "heed",
          "need", "keep", "keen", "keel", "Jeep", "jeer", "Lee", "leek",
          "leer", "leech"
        ],
        sentences: [
          "1) The Jeep went up the steep hill.",
          "2) Fred will greet Tom and let him in.",
          "3) Beth will meet Chuck at the bus stop.",
          "4) The man in the cab will need to get a fee.",
          "5) If you keep still, the deer will not flee.",
          "6) A ship from the Greek fleet sat at the dock.",
          "7) Lee had a keen wit and did well on the test.",
          "8) Ann sat on the bank and got her feet wet in the creek.",
          "9) Did Rex feel bad? Did Mom feed him and keep him in bed?"
        ],
        assessmentItems: [
          { id: "1", prompt: "What kind of vehicle went up the steep hill?", options: [{id:"a",text:"the Jeep",is_correct:true},{id:"b",text:"a cab",is_correct:false},{id:"c",text:"a bus",is_correct:false},{id:"d",text:"a fleet",is_correct:false}]},
          { id: "2", prompt: "What will Fred do when he sees Tom?", options: [{id:"a",text:"greet him",is_correct:true},{id:"b",text:"feed him",is_correct:false},{id:"c",text:"jeer him",is_correct:false},{id:"d",text:"meet him",is_correct:false}]},
          { id: "3", prompt: "Where will Beth meet Chuck?", options: [{id:"a",text:"at the bus stop",is_correct:true},{id:"b",text:"at the dock",is_correct:false},{id:"c",text:"in the creek",is_correct:false},{id:"d",text:"on the hill",is_correct:false}]},
          { id: "4", prompt: "What does the man in the cab need to get?", options: [{id:"a",text:"a fee",is_correct:true},{id:"b",text:"a leek",is_correct:false},{id:"c",text:"a fleet",is_correct:false},{id:"d",text:"a Jeep",is_correct:false}]},
          { id: "5", prompt: "What must you do so the deer does not flee?", options: [{id:"a",text:"keep still",is_correct:true},{id:"b",text:"greet it",is_correct:false},{id:"c",text:"feed it",is_correct:false},{id:"d",text:"jeer it",is_correct:false}]},
          { id: "6", prompt: "Where was the ship from the Greek fleet?", options: [{id:"a",text:"at the dock",is_correct:true},{id:"b",text:"in the creek",is_correct:false},{id:"c",text:"on the hill",is_correct:false},{id:"d",text:"in bed",is_correct:false}]},
          { id: "7", prompt: "How did Lee do on the test?", options: [{id:"a",text:"he did well",is_correct:true},{id:"b",text:"he felt bad",is_correct:false},{id:"c",text:"he got wet",is_correct:false},{id:"d",text:"he had a fee",is_correct:false}]},
          { id: "8", prompt: "Where did Ann get her feet wet?", options: [{id:"a",text:"in the creek",is_correct:true},{id:"b",text:"at the dock",is_correct:false},{id:"c",text:"on the hill",is_correct:false},{id:"d",text:"at the bus stop",is_correct:false}]},
          { id: "9", prompt: "What did Mom do for Rex when he felt bad?", options: [{id:"a",text:"feed him and keep him in bed",is_correct:true},{id:"b",text:"greet him and let him in",is_correct:false},{id:"c",text:"meet him at the bus stop",is_correct:false},{id:"d",text:"give him a keen wit",is_correct:false}]},
          { id: "10", prompt: "Which word describes a very sharp or intelligent wit?", options: [{id:"a",text:"keen",is_correct:true},{id:"b",text:"meek",is_correct:false},{id:"c",text:"free",is_correct:false},{id:"d",text:"green",is_correct:false}]},
          { id: "11", prompt: "Which word means to run away?", options: [{id:"a",text:"flee",is_correct:true},{id:"b",text:"feel",is_correct:false},{id:"c",text:"feet",is_correct:false},{id:"d",text:"feed",is_correct:false}]},
          { id: "12", prompt: "Which word is a type of vegetable like an onion?", options: [{id:"a",text:"leek",is_correct:true},{id:"b",text:"leech",is_correct:false},{id:"c",text:"leer",is_correct:false},{id:"d",text:"keel",is_correct:false}]},
          { id: "13", prompt: "Which word describes a blood-sucking worm?", options: [{id:"a",text:"leech",is_correct:true},{id:"b",text:"leek",is_correct:false},{id:"c",text:"leer",is_correct:false},{id:"d",text:"keel",is_correct:false}]},
          { id: "14", prompt: "To make fun of someone is to ____.", options: [{id:"a",text:"jeer",is_correct:true},{id:"b",text:"greet",is_correct:false},{id:"c",text:"heed",is_correct:false},{id:"d",text:"keep",is_correct:false}]},
          { id: "15", prompt: "Which word is the bottom part of a ship?", options: [{id:"a",text:"keel",is_correct:true},{id:"b",text:"fleet",is_correct:false},{id:"c",text:"heel",is_correct:false},{id:"d",text:"fee",is_correct:false}]},
          { id: "16", prompt: "Which word is a color?", options: [{id:"a",text:"green",is_correct:true},{id:"b",text:"greed",is_correct:false},{id:"c",text:"Greek",is_correct:false},{id:"d",text:"glee",is_correct:false}]},
          { id: "17", prompt: "Great joy or happiness is called ____.", options: [{id:"a",text:"glee",is_correct:true},{id:"b",text:"fee",is_correct:false},{id:"c",text:"free",is_correct:false},{id:"d",text:"meek",is_correct:false}]},
          { id: "18", prompt: "Quiet and gentle is called ____.", options: [{id:"a",text:"meek",is_correct:true},{id:"b",text:"keen",is_correct:false},{id:"c",text:"greed",is_correct:false},{id:"d",text:"meet",is_correct:false}]},
          { id: "19", prompt: "The back part of the foot is the ____.", options: [{id:"a",text:"heel",is_correct:true},{id:"b",text:"keel",is_correct:false},{id:"c",text:"feet",is_correct:false},{id:"d",text:"heed",is_correct:false}]},
          { id: "20", prompt: "To pay attention or listen is to ____.", options: [{id:"a",text:"heed",is_correct:true},{id:"b",text:"need",is_correct:false},{id:"c",text:"greet",is_correct:false},{id:"d",text:"leer",is_correct:false}]}
        ]
      };

      function renderWords() {
        document.getElementById('word-list').innerHTML =
          CHAPTER_CONFIG.contentWords.map(w => `<span class="word-item">${w}</span>`).join('');
      }

      function renderSentences() {
        document.getElementById('sentences').innerHTML =
          CHAPTER_CONFIG.sentences.map(s => `<p>${s}</p>`).join('');
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [{ label: "Home", url: "../index.html", active: false }];
        for (let i = 0; i < 4; i++) {
          const c = currentChapter + i;
          const lessonNum = c + 1;
          if (c > maxChapter) break;
          buttons.push({ label: `Lesson ${lessonNum}`, url: `chapter-${c}.html`, active: i === 0 });
        }
        nav.innerHTML = buttons.map(b => `<a href="${b.url}" class="chapter-btn ${b.active ? 'active' : ''}">${b.label}</a>`).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};
        form.innerHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          const opts = shuffle([...q.options]);
          const correct = q.options.find(o => o.is_correct);
          window.quizCorrectMap[q.id] = correct.id;
          const optHtml = opts.map((o, i) => {
            const L = String.fromCharCode(65 + i);
            return `<div class="option"><label><input type="radio" name="q${q.id}" value="${o.id}" required> ${L}. ${o.text}</label></div>`;
          }).join('');
          return `<div class="question"><strong>${q.id}. ${q.prompt}</strong><div class="options">${optHtml}</div></div>`;
        }).join('');
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0, correctList = [], incorrectList = [];
        items.forEach((item, i) => {
          const ans = answers[i];
          const correctId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctId);
          if (ans === correctId) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt} ‚Üí ‚úÖ ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt} ‚Üí ‚ùå Your answer: ${item.options.find(o => o.id === ans)?.text || '‚Äî'} | ‚úÖ ${correctOpt.text}`);
          }
        });

        const score = correctCount, mastery = score >= 15;
        const timeOnTask = Math.floor((Date.now() - window.startTime) / 1000);
        const attemptsKey = `quiz_attempts_${currentChapter}`;
        const attempts = (parseInt(localStorage.getItem(attemptsKey)) || 0) + 1;
        localStorage.setItem(attemptsKey, attempts);
        localStorage.setItem(`mastery_${currentChapter}`, mastery ? '1' : '0');
        const studentName = localStorage.getItem('student_name') || '[Name]';

        let report = `*Mini OpenStax ‚Äî ${CHAPTER_CONFIG.title}*\nStudent: ${studentName}\nScore: ${score}/20 (${Math.round(score/20*100)}%) ‚Äî ${mastery ? '‚úÖ MASTERED' : '‚ùå Needs Review'}\nTime: ${timeOnTask}s | Attempts: ${attempts}\n\n`;
        if (correctList.length) report += `‚úÖ CORRECT:\n${correctList.join('\n')}\n\n`;
        if (incorrectList.length) report += `‚ùå INCORRECT:\n${incorrectList.join('\n')}\n\n`;
        report += `Report generated via Mini OpenStax.`;

        const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(report)}`;
        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}/20</h3>
            <p><strong>${mastery ? 'üéâ Excellent!' : 'Keep practicing.'}</strong></p>
            <p>Time: ${timeOnTask}s | Attempts: ${attempts}</p>
            <a href="${url}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report via WhatsApp</a>
          </div>`;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const el = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(el ? el.value : null);
          }
          if (answers.includes(null)) { alert("Please answer all questions."); return; }
          showFeedback(answers);
        });
      }

      function initNamePrompt() {
        const saved = localStorage.getItem('student_name');
        const promptDiv = document.getElementById('student-name-prompt');
        const quizDiv = document.getElementById('quiz-container');
        const display = document.getElementById('name-display');
        const input = document.getElementById('student-name');
        const buttons = document.getElementById('name-buttons');

        promptDiv.style.display = 'block';
        if (saved) {
          display.innerHTML = `<p><strong>Current name:</strong> ${saved}</p>`;
          buttons.innerHTML = `<button type="button" class="btn" id="keep-btn">‚úÖ Keep This Name</button> <button type="button" class="btn btn-secondary" id="change-btn">‚úèÔ∏è Change</button>`;
          document.getElementById('keep-btn').onclick = () => { promptDiv.style.display = 'none'; quizDiv.style.display = 'block'; };
          document.getElementById('change-btn').onclick = () => { display.style.display = 'none'; input.style.display = 'block'; input.value = ''; input.focus(); buttons.innerHTML = `<button type="button" class="btn" id="save-new">üíæ Save & Start</button>`; document.getElementById('save-new').onclick = saveName; };
        } else {
          display.style.display = 'none'; input.style.display = 'block'; buttons.innerHTML = `<button type="button" class="btn" id="save-first">üíæ Save & Start</button>`; document.getElementById('save-first').onclick = saveName;
        }

        function saveName() {
          const name = input.value.trim();
          if (name) { localStorage.setItem('student_name', name); promptDiv.style.display = 'none'; quizDiv.style.display = 'block'; }
          else { alert("Please enter your name."); }
        }
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation(); renderWords(); renderSentences(); renderQuiz(); setupQuizListeners(); initNamePrompt();
      }

      init();
    })();
  </script>
</body>
</html>
