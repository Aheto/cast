<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 221 ‚Äî R-Controlled ur = /…ôr/"/>
  <title>Mini OpenStax ‚Äî Lesson 221: ur = /…ôr/</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn { background: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
    .btn:hover { background: #218838; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 221: ur = /…ôr/</h1>
        <div class="lo-tags" id="lo-tags">LO PH221: Decode words with r-controlled ur = /…ôr/</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Words with the <strong>r-controlled</strong> <em>ur</em> making the <strong>/…ôr/</strong> sound:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud. All words are decodable from Lessons 2‚Äì221:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div class="quiz" id="quiz-container">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      const currentChapter = 220;   // chapter-220.html = Lesson 221
      const maxChapter = 261;

      const CHAPTER_CONFIG = {
        title: "Lesson 221: ur = /…ôr/",
        loTags: ["LO PH221: Decode words with r-controlled ur = /…ôr/"],
        contentWords: [
          "urgent", "burden", "burglar", "current", "during", "furnish", "further", "murder", "murmur",
          "turkey", "turtle", "pursue", "pursuit", "purple", "survey", "surprise", "survive", "surround", "surrender",
          "jury", "furry", "hurry", "Thursday", "Arthur", "return", "absurd", "disturb"
        ],
        sentences: [
          "The turtle has a hard shell on its back.",
          "Arthur must hurry so he won't be late to class.",
          "If you borrow something, you must return it later.",
          "Jane can read about a current event in the newspaper.",
          "On Thursday, Arthur went to a surprise birthday party.",
          "The burglar set off an alarm when he broke into the house.",
          "Jean will carve up the roast turkey and serve it at dinner.",
          "During the battle, the army tried to surround the enemy and force them to surrender."
        ],
        whatsappNumber: "233257320201",
        assessmentItems: [
          { id: "1", prompt: "Which word contains 'ur' making /…ôr/?", options: [{id:"a",text:"turtle",is_correct:true},{id:"b",text:"tune",is_correct:false},{id:"c",text:"tape",is_correct:false},{id:"d",text:"top",is_correct:false}] },
          { id: "2", prompt: "Which is NOT a Lesson 221 word?", options: [{id:"a",text:"surrender",is_correct:false},{id:"b",text:"disturb",is_correct:false},{id:"c",text:"mirror",is_correct:true},{id:"d",text:"burglar",is_correct:false}] },
          { id: "3", prompt: "In 'hurry', what sound does 'ur' make?", options: [{id:"a",text:"/…ôr/",is_correct:true},{id:"b",text:"/√§r/",is_correct:false},{id:"c",text:"/√¥r/",is_correct:false},{id:"d",text:"/≈´r/",is_correct:false}] },
          { id: "4", prompt: "Which word means 'a person who breaks into a house to steal'?", options: [{id:"a",text:"burglar",is_correct:true},{id:"b",text:"jury",is_correct:false},{id:"c",text:"furry",is_correct:false},{id:"d",text:"turkey",is_correct:false}] },
          { id: "5", prompt: "How many letters in 'surround'?", options: [{id:"a",text:"8",is_correct:true},{id:"b",text:"7",is_correct:false},{id:"c",text:"9",is_correct:false},{id:"d",text:"6",is_correct:false}] },
          { id: "6", prompt: "Which sentence uses only Lesson 221 words?", options: [{id:"a",text:"The turtle has a hard shell on its back.",is_correct:true},{id:"b",text:"She sat on a mat.",is_correct:false},{id:"c",text:"He ran fast.",is_correct:false},{id:"d",text:"They played ball.",is_correct:false}] },
          { id: "7", prompt: "Which word refers to a large bird often eaten on holidays?", options: [{id:"a",text:"turkey",is_correct:true},{id:"b",text:"turtle",is_correct:false},{id:"c",text:"purple",is_correct:false},{id:"d",text:"survey",is_correct:false}] },
          { id: "8", prompt: "What syllable type is in 'urgent'?", options: [{id:"a",text:"R-controlled",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Open syllable",is_correct:false},{id:"d",text:"Closed syllable",is_correct:false}] },
          { id: "9", prompt: "In 'On Thursday, Arthur went to a surprise birthday party,' how many Lesson 221 words?", options: [{id:"a",text:"3",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"1",is_correct:false},{id:"d",text:"4",is_correct:false}] },
          { id: "10", prompt: "Which word means 'to give back after borrowing'?", options: [{id:"a",text:"return",is_correct:true},{id:"b",text:"pursue",is_correct:false},{id:"c",text:"furnish",is_correct:false},{id:"d",text:"survey",is_correct:false}] },
          { id: "11", prompt: "Which word describes something happening now or up to date?", options: [{id:"a",text:"current",is_correct:true},{id:"b",text:"absurd",is_correct:false},{id:"c",text:"furry",is_correct:false},{id:"d",text:"murmur",is_correct:false}] },
          { id: "12", prompt: "Which word ends with 'ur' and means 'to encircle completely'?", options: [{id:"a",text:"surround",is_correct:true},{id:"b",text:"surrender",is_correct:false},{id:"c",text:"surprise",is_correct:false},{id:"d",text:"survey",is_correct:false}] },
          { id: "13", prompt: "Which sentence is from Lesson 221?", options: [{id:"a",text:"Jean will carve up the roast turkey and serve it at dinner.",is_correct:true},{id:"b",text:"She likes apples.",is_correct:false},{id:"c",text:"He jumped high.",is_correct:false},{id:"d",text:"They walked home.",is_correct:false}] },
          { id: "14", prompt: "How many consonants in 'burglar'?", options: [{id:"a",text:"6",is_correct:true},{id:"b",text:"5",is_correct:false},{id:"c",text:"7",is_correct:false},{id:"d",text:"4",is_correct:false}] },
          { id: "15", prompt: "Which word means 'to move quickly, often in excitement or panic'?", options: [{id:"a",text:"hurry",is_correct:true},{id:"b",text:"jury",is_correct:false},{id:"c",text:"furry",is_correct:false},{id:"d",text:"Arthur",is_correct:false}] },
          { id: "16", prompt: "What phonics pattern is in 'during'?", options: [{id:"a",text:"R-controlled ur = /…ôr/",is_correct:true},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Closed syllable",is_correct:false},{id:"d",text:"Vowel team 'ie'",is_correct:false}] },
          { id: "17", prompt: "Which word refers to a group of people who decide a court case?", options: [{id:"a",text:"jury",is_correct:true},{id:"b",text:"burglar",is_correct:false},{id:"c",text:"turkey",is_correct:false},{id:"d",text:"turtle",is_correct:false}] },
          { id: "18", prompt: "Which word might complete: 'Don‚Äôt ___ the peace.'?", options: [{id:"a",text:"disturb",is_correct:true},{id:"b",text:"return",is_correct:false},{id:"c",text:"hurry",is_correct:false},{id:"d",text:"furnish",is_correct:false}] },
          { id: "19", prompt: "Which word appears in both the word list and sentences?", options: [{id:"a",text:"turtle",is_correct:true},{id:"b",text:"Arthur",is_correct:true},{id:"c",text:"turkey",is_correct:true},{id:"d",text:"All of the above",is_correct:true}] },
          { id: "20", prompt: "What phonics concept is taught in Lesson 221?", options: [{id:"a",text:"R-controlled ur = /…ôr/",is_correct:true},{id:"b",text:"Split vowel pairs",is_correct:false},{id:"c",text:"Magic E",is_correct:false},{id:"d",text:"Vowel teams",is_correct:false}] }
        ]
      };

      function renderWords() {
        const container = document.getElementById('word-list');
        container.innerHTML = CHAPTER_CONFIG.contentWords.map(word =>
          `<span class="word-item">${word}</span>`
        ).join('');
      }

      function renderSentences() {
        const container = document.getElementById('sentences');
        container.innerHTML = CHAPTER_CONFIG.sentences.map(s =>
          `<p>${s}</p>`
        ).join('');
      }

      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [];
        buttons.push({ label: "Home", url: "../index.html", active: false });
        for (let i = 0; i < 4; i++) {
          const chapterNum = currentChapter + i;
          if (chapterNum > maxChapter) break;
          const lessonNum = chapterNum + 1;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${chapterNum}.html`,
            active: (i === 0)
          });
        }
        nav.innerHTML = buttons.map(btn => `
          <a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">
            ${btn.label}
          </a>
        `).join('');
      }

      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        window.quizCorrectMap = {};

        const quizHTML = CHAPTER_CONFIG.assessmentItems.map(q => {
          let shuffledOptions = [...q.options];
          shuffle(shuffledOptions);

          const correctOpt = q.options.find(opt => opt.is_correct);
          window.quizCorrectMap[q.id] = correctOpt.id;

          const optionsHTML = shuffledOptions.map((opt, idx) => {
            const label = String.fromCharCode(97 + idx).toUpperCase();
            return `
              <div class="option">
                <label>
                  <input type="radio" name="q${q.id}" value="${opt.id}" required> ${label}. ${opt.text}
                </label>
              </div>
            `;
          }).join('');

          return `
            <div class="question">
              <strong>${q.id}. ${q.prompt}</strong>
              <div class="options">
                ${optionsHTML}
              </div>
            </div>
          `;
        }).join('');

        form.innerHTML = quizHTML;
      }

      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0;
        let correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const userAns = answers[i];
          const correctOptId = window.quizCorrectMap[item.id];
          const correctOpt = item.options.find(o => o.id === correctOptId);
          const isCorrect = userAns === correctOptId;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt}\n   ‚úÖ Correct: ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt}\n   ‚ùå You chose: ${item.options.find(o => o.id === userAns)?.text || '‚Äî'}\n   ‚úÖ Correct: ${correctOpt.text}`);
          }
        });

        const score = `${correctCount}/20}`;
        const summary = `*Mini OpenStax ‚Äî Phonics Lesson 221*\nStudent: [Name]\nScore: ${score}\n\n`;
        const correctStr = correctList.length ? '‚úÖ CORRECT:\n' + correctList.join('\n\n') + '\n\n' : '';
        const incorrectStr = incorrectList.length ? '‚ùå INCORRECT:\n' + incorrectList.join('\n\n') : '';
        const message = encodeURIComponent(summary + correctStr + incorrectStr + `\nReport generated via Mini OpenStax. Share with instructor: https://wa.me/${CHAPTER_CONFIG.whatsappNumber}`);
        const whatsappLink = `https://wa.me/${CHAPTER_CONFIG.whatsappNumber}?text=${message}`;

        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}</h3>
            <p><strong>${correctCount >= 15 ? 'Excellent! You‚Äôve mastered r-controlled ur=/…ôr/!' : correctCount >= 10 ? 'Good! Review missed items.' : 'Practice Lesson 221 words again.'}</strong></p>
            <p><a href="${whatsappLink}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report to Instructor</a></p>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const selected = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(selected ? selected.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
