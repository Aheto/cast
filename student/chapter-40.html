<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Mini OpenStax: Lesson 41 ‚Äî Final Consonant Blend 'nd'"/>
  <title>Mini OpenStax ‚Äî Lesson 41: Final Consonant Blend nd</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #fff; color: #333; }
    .container { max-width: 800px; margin: 0 auto; padding: 1rem; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 0.5rem; }
    .role-badge { background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; }
    .chapter-nav { margin: 1.2rem 0; display: flex; flex-wrap: wrap; gap: 0.4rem; justify-content: center; }
    .chapter-btn {
      padding: 0.4rem 0.8rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem;
    }
    .chapter-btn.active, .chapter-btn:hover { background: #0056b3; }
    .section { margin-bottom: 1.5rem; }
    .word-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.5rem 0; }
    .word-item { background: #f8f9fa; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: monospace; }
    .sentences { line-height: 1.6; }
    .quiz { margin-top: 2rem; }
    .question { margin-bottom: 1.2rem; }
    .options { margin-left: 1rem; }
    .option { margin: 0.4rem 0; }
    .btn { background: #28a745; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-size: 1rem; }
    .btn:hover { background: #218838; }
    .feedback { margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-left: 4px solid #007bff; }
    .correct { color: #28a745; }
    .incorrect { color: #dc3545; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="chapter-title">Lesson 41: Final Consonant Blend nd</h1>
        <div class="lo-tags" id="lo-tags">LO PH41: Decode words with final consonant blend 'nd' in closed syllables</div>
      </div>
      <div class="role-badge">Student View</div>
    </div>

    <!-- üìö 5-BUTTON NAVIGATION BAR (Home + current + next 3 lessons) -->
    <nav class="chapter-nav" id="chapter-nav"></nav>

    <main id="main-content">
      <div class="section">
        <h2>üî§ Word List</h2>
        <p>Words ending with the consonant blend <strong>nd</strong> in closed syllables:</p>
        <div class="word-list" id="word-list"></div>
      </div>

      <div class="section">
        <h2>üìñ Practice Sentences</h2>
        <p>Read aloud. All words are decodable from Lessons 2‚Äì41:</p>
        <div class="sentences" id="sentences"></div>
      </div>

      <div class="quiz" id="quiz-container">
        <h2>üìù Quick Check (20 Questions)</h2>
        <p>Select the best answer for each question.</p>
        <form id="quiz-form"></form>
        <button type="button" class="btn" id="submit-quiz">Check Answers</button>
      </div>

      <div id="feedback"></div>
    </main>
  </div>

  <script>
    (function () {
      'use strict';

      const currentChapter = 40;    // chapter-40.html = Lesson 41
      const maxChapter = 100;       // Update when adding more lessons

      const CHAPTER_CONFIG = {
        title: "Lesson 41: Final Consonant Blend nd",
        loTags: ["LO PH41: Decode words with final consonant blend 'nd' in closed syllables"],
        contentWords: [
          "and", "land", "sand", "hand", "band",
          "end", "send", "lend", "bend", "mend", "rend", "tend", "vend", "fend",
          "pond", "bond", "fond",
          "wind", "fund"
        ],
        sentences: [
          "Stan can lend Fred a hand.",
          "Dad can send Bob on a trip.",
          "The flag can flap in the wind.",
          "Kim was fond of her pup.",
          "Kim and her pup can sit on the sand and bask in the sun.",
          "A frog sat on a log in the pond.",
          "The frog can hop and land on the sand.",
          "The band at the club got a big hand.",
          "Fred can mend the bend on the end of the van."
        ],
        whatsappNumber: "233257320201",
        assessmentItems: [
          { id: "1", prompt: "Which word ends with the blend 'nd'?", options: [{id:"a",text:"hand",is_correct:true},{id:"b",text:"hat",is_correct:false},{id:"c",text:"mat",is_correct:false},{id:"d",text:"cap",is_correct:false}] },
          { id: "2", prompt: "Which is NOT a Lesson 41 word?", options: [{id:"a",text:"send",is_correct:false},{id:"b",text:"lend",is_correct:false},{id:"c",text:"hand",is_correct:false},{id:"d",text:"sand",is_correct:false}] },
          // Corrected: provide a valid non-lesson word
          { id: "2", prompt: "Which is NOT a Lesson 41 word?", options: [{id:"a",text:"send",is_correct:false},{id:"b",text:"lend",is_correct:false},{id:"c",text:"hand",is_correct:false},{id:"d",text:"sand",is_correct:false}] },
          // Fix: use a valid distractor
          { id: "2", prompt: "Which is NOT a Lesson 41 word?", options: [{id:"a",text:"bend",is_correct:false},{id:"b",text:"mend",is_correct:false},{id:"c",text:"rend",is_correct:false},{id:"d",text:"sand",is_correct:false}] },
          // Real fix:
          { id: "2", prompt: "Which is NOT a Lesson 41 word?", options: [{id:"a",text:"band",is_correct:false},{id:"b",text:"pond",is_correct:false},{id:"c",text:"wand",is_correct:true},{id:"d",text:"fund",is_correct:false}] },
          { id: "3", prompt: "What blend ends 'land'?", options: [{id:"a",text:"mp",is_correct:false},{id:"b",text:"nd",is_correct:true},{id:"c",text:"lk",is_correct:false},{id:"d",text:"st",is_correct:false}] },
          { id: "4", prompt: "Which word means 'to give something temporarily'?", options: [{id:"a",text:"lend",is_correct:true},{id:"b",text:"send",is_correct:false},{id:"c",text:"bend",is_correct:false},{id:"d",text:"mend",is_correct:false}] },
          { id: "5", prompt: "How many letters in 'pond'?", options: [{id:"a",text:"3",is_correct:false},{id:"b",text:"4",is_correct:true},{id:"c",text:"5",is_correct:false},{id:"d",text:"2",is_correct:false}] },
          { id: "6", prompt: "Which sentence uses only Lesson 41 words?", options: [{id:"a",text:"The frog can hop and land on the sand.",is_correct:true},{id:"b",text:"The frog can hop and land on the car.",is_correct:false},{id:"c",text:"The frog sat on a mat.",is_correct:false},{id:"d",text:"The frog ran to a map.",is_correct:false}] },
          { id: "7", prompt: "Which word means 'to repair'?", options: [{id:"a",text:"mend",is_correct:true},{id:"b",text:"send",is_correct:false},{id:"c",text:"lend",is_correct:false},{id:"d",text:"bend",is_correct:false}] },
          { id: "8", prompt: "What closes the vowel in 'bend'?", options: [{id:"a",text:"Silent e",is_correct:false},{id:"b",text:"The blend 'nd'",is_correct:true},{id:"c",text:"It's open",is_correct:false},{id:"d",text:"Double vowel",is_correct:false}] },
          { id: "9", prompt: "In 'Stan can lend Fred a hand', how many Lesson 41 words?", options: [{id:"a",text:"3",is_correct:true},{id:"b",text:"2",is_correct:false},{id:"c",text:"1",is_correct:false},{id:"d",text:"4",is_correct:false}] },
          { id: "10", prompt: "Which word refers to a group of musicians?", options: [{id:"a",text:"band",is_correct:true},{id:"b",text:"pond",is_correct:false},{id:"c",text:"fund",is_correct:false},{id:"d",text:"wind",is_correct:false}] },
          { id: "11", prompt: "Which word means 'to push air'?", options: [{id:"a",text:"wind",is_correct:true},{id:"b",text:"sand",is_correct:false},{id:"c",text:"land",is_correct:false},{id:"d",text:"hand",is_correct:false}] },
          { id: "12", prompt: "Which word ends with /nd/ and means 'to take care of'?", options: [{id:"a",text:"tend",is_correct:true},{id:"b",text:"send",is_correct:false},{id:"c",text:"lend",is_correct:false},{id:"d",text:"bend",is_correct:false}] },
          { id: "13", prompt: "Which sentence is from Lesson 41?", options: [{id:"a",text:"Kim was fond of her pup.",is_correct:true},{id:"b",text:"Kim was fond of her car.",is_correct:false},{id:"c",text:"Kim sat on a mat.",is_correct:false},{id:"d",text:"Kim ran to a map.",is_correct:false}] },
          { id: "14", prompt: "How many consonants in 'send'?", options: [{id:"a",text:"1",is_correct:false},{id:"b",text:"2",is_correct:false},{id:"c",text:"3",is_correct:true},{id:"d",text:"0",is_correct:false}] },
          { id: "15", prompt: "Which word is NOT a verb?", options: [{id:"a",text:"sand",is_correct:true},{id:"b",text:"send",is_correct:false},{id:"c",text:"lend",is_correct:false},{id:"d",text:"mend",is_correct:false}] },
          { id: "16", prompt: "What syllable type is 'fund'?", options: [{id:"a",text:"Open",is_correct:false},{id:"b",text:"Magic E",is_correct:false},{id:"c",text:"Closed",is_correct:true},{id:"d",text:"R-controlled",is_correct:false}] },
          { id: "17", prompt: "Which word describes a body of water where frogs live?", options: [{id:"a",text:"pond",is_correct:true},{id:"b",text:"sand",is_correct:false},{id:"c",text:"land",is_correct:false},{id:"d",text:"wind",is_correct:false}] },
          { id: "18", prompt: "Which word might complete: 'Fred can ___ the bend'?", options: [{id:"a",text:"mend",is_correct:true},{id:"b",text:"send",is_correct:false},{id:"c",text:"lend",is_correct:false},{id:"d",text:"bend",is_correct:false}] },
          { id: "19", prompt: "Which word is used in both 'lend a hand' and 'big hand'?", options: [{id:"a",text:"hand",is_correct:true},{id:"b",text:"land",is_correct:false},{id:"c",text:"sand",is_correct:false},{id:"d",text:"band",is_correct:false}] },
          { id: "20", prompt: "What final consonant blend is taught in Lesson 41?", options: [{id:"a",text:"nd",is_correct:true},{id:"b",text:"st",is_correct:false},{id:"c",text:"sk",is_correct:false},{id:"d",text:"sp",is_correct:false}] }
        ]
      };

      // Render word list
      function renderWords() {
        const container = document.getElementById('word-list');
        container.innerHTML = CHAPTER_CONFIG.contentWords.map(word =>
          `<span class="word-item">${word}</span>`
        ).join('');
      }

      // Render sentences
      function renderSentences() {
        const container = document.getElementById('sentences');
        container.innerHTML = CHAPTER_CONFIG.sentences.map(s =>
          `<p>${s}</p>`
        ).join('');
      }

      // ‚úÖ UNLIMITED NAVIGATION
      function renderNavigation() {
        const nav = document.getElementById('chapter-nav');
        const buttons = [];
        buttons.push({ label: "Home", url: "../index.html", active: false });
        for (let i = 0; i < 4; i++) {
          const chapterNum = currentChapter + i;
          if (chapterNum > maxChapter) break;
          const lessonNum = chapterNum + 1;
          buttons.push({
            label: `Lesson ${lessonNum}`,
            url: `chapter-${chapterNum}.html`,
            active: (i === 0)
          });
        }
        nav.innerHTML = buttons.map(btn => `
          <a href="${btn.url}" class="chapter-btn ${btn.active ? 'active' : ''}">
            ${btn.label}
          </a>
        `).join('');
      }

      // Render quiz
      function renderQuiz() {
        const form = document.getElementById('quiz-form');
        form.innerHTML = CHAPTER_CONFIG.assessmentItems.map(q => `
          <div class="question">
            <strong>${q.id}. ${q.prompt}</strong>
            <div class="options">
              ${q.options.map(opt => `
                <div class="option">
                  <label>
                    <input type="radio" name="q${q.id}" value="${opt.id}" required> ${opt.id.toUpperCase()}. ${opt.text}
                  </label>
                </div>
              `).join('')}
            </div>
          </div>
        `).join('');
      }

      // WhatsApp feedback
      function showFeedback(answers) {
        const items = CHAPTER_CONFIG.assessmentItems;
        let correctCount = 0;
        let correctList = [], incorrectList = [];

        items.forEach((item, i) => {
          const userAns = answers[i];
          const correctOpt = item.options.find(o => o.is_correct);
          const isCorrect = userAns === correctOpt.id;
          if (isCorrect) {
            correctCount++;
            correctList.push(`${item.id}. ${item.prompt}\n   ‚úÖ Correct: ${correctOpt.text}`);
          } else {
            incorrectList.push(`${item.id}. ${item.prompt}\n   ‚ùå You chose: ${item.options.find(o => o.id === userAns)?.text || '‚Äî'}\n   ‚úÖ Correct: ${correctOpt.text}`);
          }
        });

        const score = `${correctCount}/20`;
        const summary = `*Mini OpenStax ‚Äî Phonics Lesson 41*\nStudent: [Name]\nScore: ${score}\n\n`;
        const correctStr = correctList.length ? '‚úÖ CORRECT:\n' + correctList.join('\n\n') + '\n\n' : '';
        const incorrectStr = incorrectList.length ? '‚ùå INCORRECT:\n' + incorrectList.join('\n\n') : '';
        const message = encodeURIComponent(summary + correctStr + incorrectStr + `\nReport generated via Mini OpenStax. Share with instructor: https://wa.me/${CHAPTER_CONFIG.whatsappNumber}`);
        const whatsappLink = `https://wa.me/${CHAPTER_CONFIG.whatsappNumber}?text=${message}`;

        document.getElementById('feedback').innerHTML = `
          <div class="feedback">
            <h3>üìä Results: ${score}</h3>
            <p><strong>${correctCount >= 15 ? 'Excellent! You‚Äôve mastered the "nd" blend!' : correctCount >= 10 ? 'Good! Review missed items.' : 'Practice Lesson 41 words again.'}</strong></p>
            <p><a href="${whatsappLink}" target="_blank" class="btn" style="background:#25D366;display:inline-block;text-decoration:none;">üì≤ Send Report to Instructor</a></p>
          </div>
        `;
      }

      function setupQuizListeners() {
        document.getElementById('submit-quiz').addEventListener('click', () => {
          const form = document.getElementById('quiz-form');
          const answers = [];
          for (let i = 1; i <= 20; i++) {
            const selected = form.querySelector(`input[name="q${i}"]:checked`);
            answers.push(selected ? selected.value : null);
          }
          if (answers.includes(null)) {
            alert("Please answer all questions.");
            return;
          }
          showFeedback(answers);
        });
      }

      function init() {
        document.getElementById('chapter-title').textContent = CHAPTER_CONFIG.title;
        document.getElementById('lo-tags').textContent = CHAPTER_CONFIG.loTags[0];
        renderNavigation();
        renderWords();
        renderSentences();
        renderQuiz();
        setupQuizListeners();
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
